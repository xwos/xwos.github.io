<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>XWOS API: xwos/mm/mempool/objcache.c 文件参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<a href="/" class="github-corner" title="返回首页">
  <svg viewBox="0 0 250 250" style="position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
    <path
      d="M 0 0 L 250 250 L 250 0 L 0 0 z M 181.19336 6.25 A 18.281986 19.638775 0 0 1 192.79297 10.798828 L 241.54492 54.201172 A 6.0939954 6.5462585 0 0 1 237.64453 65.787109 L 233.13477 65.787109 A 3.0469979 3.2731292 0 0 0 230.08789 69.060547 L 230.08789 111.61133 A 18.281986 19.638775 0 0 1 211.80664 131.25 L 205.71289 131.25 A 12.187991 13.092517 0 0 1 193.52344 118.1582 L 193.52344 98.519531 A 12.187991 13.092517 0 0 0 181.33594 85.425781 A 12.187991 13.092517 0 0 0 169.14844 98.519531 L 169.14844 118.1582 A 12.187991 13.092517 0 0 1 156.95898 131.25 L 150.86523 131.25 A 18.281986 19.638775 0 0 1 132.58398 111.61133 L 132.58398 68.994141 A 3.0469979 3.2731292 0 0 0 129.29297 65.722656 L 124.7832 65.722656 A 6.0939954 6.5462585 0 0 1 120.88281 54.201172 L 169.39258 10.798828 A 18.281986 19.638775 0 0 1 181.19336 6.25 z "/>
  </svg>
</a>
<style>.github-corner:hover</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XWOS API
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">XWOS API参考手册</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('objcache_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">宏定义</a> &#124;
<a href="#func-members">函数</a>  </div>
  <div class="headertitle"><div class="title">objcache.c 文件参考</div></div>
</div><!--header-->
<div class="contents">

<p>XWOS内存管理：内存池：对象缓存  
<a href="#details">更多...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="xwos_2standard_8h_source.html">xwos/standard.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="xwbop_8h_source.html">xwos/lib/xwbop.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="xwaop_8h_source.html">xwos/lib/xwaop.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="bclst_8h_source.html">xwos/lib/bclst.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="lfq_8h_source.html">xwos/lib/lfq.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="lock_2seqlock_8h_source.html">xwos/osal/lock/seqlock.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="xwos_2mm_2common_8h_source.html">xwos/mm/common.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="page_8h_source.html">xwos/mm/mempool/page.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="objcache_8h_source.html">xwos/mm/mempool/objcache.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
objcache.c 的引用(Include)关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c__incl.png" border="0" usemap="#axwos_2mm_2mempool_2objcache_8c" alt=""/></div>
<map name="axwos_2mm_2mempool_2objcache_8c" id="axwos_2mm_2mempool_2objcache_8c">
<area shape="rect" title="XWOS内存管理：内存池：对象缓存" alt="" coords="677,5,879,31"/>
<area shape="rect" href="xwos_2standard_8h.html" title="XWOS的标准头文件" alt="" coords="723,387,841,412"/>
<area shape="poly" title=" " alt="" coords="677,31,612,46,581,57,552,71,527,88,507,109,495,134,490,164,490,239,496,273,512,302,536,326,567,345,601,361,638,373,709,388,708,393,637,378,599,366,564,350,533,330,508,305,491,275,485,240,485,163,489,132,503,106,523,84,549,66,579,52,611,41,676,26"/>
<area shape="rect" href="xwbop_8h.html" title="XWOS通用库：位操作" alt="" coords="327,152,450,177"/>
<area shape="poly" title=" " alt="" coords="677,26,627,32,573,43,520,59,470,81,433,110,406,143,402,139,429,106,467,76,518,54,572,37,626,27,676,20"/>
<area shape="rect" href="xwaop_8h.html" title="XWOS通用库：原子操作" alt="" coords="185,79,307,104"/>
<area shape="poly" title=" " alt="" coords="693,33,321,83,321,77,692,28"/>
<area shape="rect" href="bclst_8h.html" title="XWOS通用库：双循环链表" alt="" coords="525,225,639,251"/>
<area shape="poly" title=" " alt="" coords="766,33,708,83,640,154,598,215,593,212,636,150,705,79,762,29"/>
<area shape="rect" href="lfq_8h.html" title="XWOS通用库：无锁队列" alt="" coords="1271,79,1370,104"/>
<area shape="poly" title=" " alt="" coords="866,28,1234,76,1258,79,1257,84,1234,81,865,33"/>
<area shape="rect" href="lock_2seqlock_8h.html" title="操作系统抽象层：顺序锁" alt="" coords="1101,225,1271,251"/>
<area shape="poly" title=" " alt="" coords="872,28,952,46,993,59,1033,76,1078,106,1118,143,1150,180,1173,212,1169,215,1146,184,1114,147,1075,110,1030,81,991,64,951,51,871,33"/>
<area shape="rect" href="xwos_2mm_2common_8h.html" title="XWOS内存管理：通用定义" alt="" coords="1245,306,1389,331"/>
<area shape="poly" title=" " alt="" coords="880,20,1022,27,1178,39,1311,55,1357,65,1384,77,1402,101,1410,129,1408,159,1399,190,1369,250,1337,296,1333,293,1365,247,1394,189,1403,158,1404,129,1398,103,1380,81,1356,70,1310,60,1178,44,1021,33,880,26"/>
<area shape="rect" href="page_8h.html" title="XWOS内存管理：内存池：页分配器" alt="" coords="689,152,867,177"/>
<area shape="poly" title=" " alt="" coords="781,31,781,138,775,138,775,31"/>
<area shape="rect" href="objcache_8h.html" title="XWOS内存管理：内存池：对象缓存" alt="" coords="817,79,1019,104"/>
<area shape="poly" title=" " alt="" coords="802,28,884,70,882,75,799,33"/>
<area shape="rect" title=" " alt="" coords="549,607,644,632"/>
<area shape="poly" title=" " alt="" coords="750,415,709,434,669,462,644,493,625,528,604,594,599,592,620,526,639,490,666,458,706,429,748,410"/>
<area shape="rect" href="rule_8h.html" title="XWOS通用库：编译规则" alt="" coords="247,460,354,485"/>
<area shape="poly" title=" " alt="" coords="723,412,368,464,367,459,722,407"/>
<area shape="rect" href="compiler_8h.html" title="XWOS通用库：编译器宏定义" alt="" coords="424,460,559,485"/>
<area shape="poly" title=" " alt="" coords="736,415,552,459,551,454,735,409"/>
<area shape="rect" href="version_8h.html" title="XWOS版本号" alt="" coords="1047,460,1157,485"/>
<area shape="poly" title=" " alt="" coords="834,409,1038,454,1036,460,833,415"/>
<area shape="rect" href="type_8h.html" title="XWOS通用库：基本类型定义" alt="" coords="773,533,884,559"/>
<area shape="poly" title=" " alt="" coords="788,411,805,459,824,519,819,521,799,461,783,413"/>
<area shape="rect" href="error_8h.html" title="XWOS通用库：错误" alt="" coords="680,460,791,485"/>
<area shape="poly" title=" " alt="" coords="777,414,753,450,748,447,772,411"/>
<area shape="rect" title=" " alt="" coords="959,533,1098,559"/>
<area shape="poly" title=" " alt="" coords="842,404,914,421,950,437,984,458,1008,487,1023,519,1018,521,1004,490,980,462,948,441,912,426,841,409"/>
<area shape="rect" href="mb_8h.html" title="XWOS通用库：内存屏障" alt="" coords="868,460,971,485"/>
<area shape="poly" title=" " alt="" coords="805,410,886,451,884,456,803,414"/>
<area shape="poly" title=" " alt="" coords="303,485,308,521,316,540,328,557,362,575,416,590,536,609,535,614,415,595,360,580,324,561,311,543,303,523,298,486"/>
<area shape="rect" title=" " alt="" coords="152,533,263,559"/>
<area shape="poly" title=" " alt="" coords="287,487,235,527,232,523,284,483"/>
<area shape="poly" title=" " alt="" coords="502,484,582,594,578,597,498,487"/>
<area shape="rect" title=" " alt="" coords="338,533,509,559"/>
<area shape="poly" title=" " alt="" coords="482,488,446,525,442,521,478,484"/>
<area shape="poly" title=" " alt="" coords="792,561,648,605,646,600,791,556"/>
<area shape="rect" title=" " alt="" coords="825,607,971,632"/>
<area shape="poly" title=" " alt="" coords="842,557,879,595,875,599,838,561"/>
<area shape="rect" title=" " alt="" coords="731,607,801,632"/>
<area shape="poly" title=" " alt="" coords="820,561,787,598,783,594,816,557"/>
<area shape="poly" title=" " alt="" coords="752,483,804,523,801,527,749,487"/>
<area shape="rect" href="errno_8h.html" title="XWOS通用库：错误码" alt="" coords="634,533,749,559"/>
<area shape="poly" title=" " alt="" coords="730,487,708,523,703,520,726,484"/>
<area shape="poly" title=" " alt="" coords="922,486,918,523,910,543,897,561,880,572,856,582,793,598,723,609,658,616,658,611,722,604,792,592,854,577,877,567,894,557,905,541,913,521,917,485"/>
<area shape="poly" title=" " alt="" coords="938,483,1001,523,998,528,935,488"/>
<area shape="poly" title=" " alt="" coords="396,177,434,267,455,313,470,337,511,355,573,370,709,389,709,395,572,376,509,360,467,341,451,315,429,269,391,179"/>
<area shape="rect" title=" " alt="" coords="240,225,399,251"/>
<area shape="poly" title=" " alt="" coords="379,180,342,217,338,214,375,176"/>
<area shape="poly" title=" " alt="" coords="242,105,230,133,219,171,217,212,221,231,230,249,242,263,259,277,307,302,368,323,437,342,584,370,710,388,709,393,583,376,436,347,366,328,305,306,256,281,238,267,225,252,216,233,212,212,214,170,225,131,237,103"/>
<area shape="poly" title=" " alt="" coords="270,102,354,143,352,148,268,106"/>
<area shape="rect" title=" " alt="" coords="5,152,164,177"/>
<area shape="poly" title=" " alt="" coords="221,106,125,149,122,144,219,102"/>
<area shape="poly" title=" " alt="" coords="581,252,576,293,579,316,589,337,614,360,644,376,677,387,709,393,708,398,675,392,642,381,611,364,585,340,574,318,571,293,576,251"/>
<area shape="poly" title=" " alt="" coords="1348,102,1378,121,1392,135,1403,151,1427,203,1438,250,1438,273,1432,295,1420,317,1402,341,1379,349,1331,357,1181,373,855,396,855,391,1181,367,1330,352,1378,344,1399,337,1416,315,1427,293,1432,272,1433,250,1422,205,1398,153,1388,138,1375,125,1345,106"/>
<area shape="rect" title=" " alt="" coords="1253,152,1388,177"/>
<area shape="poly" title=" " alt="" coords="1323,104,1323,138,1318,138,1318,104"/>
<area shape="poly" title=" " alt="" coords="1169,253,1098,301,1073,322,1046,341,998,360,948,375,856,393,855,387,947,369,996,355,1043,336,1070,318,1095,297,1166,249"/>
<area shape="rect" href="jack_2lock_2seqlock_8h.html" title="操作系统抽象层：顺序锁接口描述" alt="" coords="896,299,1033,339"/>
<area shape="poly" title=" " alt="" coords="1155,253,1032,297,1030,292,1153,248"/>
<area shape="rect" href="irq_8h.html" title="操作系统抽象层：异常与中断" alt="" coords="1109,306,1220,331"/>
<area shape="poly" title=" " alt="" coords="1185,252,1174,293,1169,292,1180,250"/>
<area shape="poly" title=" " alt="" coords="1122,334,1091,341,856,388,855,382,1089,336,1120,329"/>
<area shape="rect" href="jack_2irq_8h.html" title="操作系统抽象层：中断接口描述" alt="" coords="1095,387,1234,412"/>
<area shape="poly" title=" " alt="" coords="1167,332,1167,373,1162,373,1162,332"/>
<area shape="poly" title=" " alt="" coords="1269,334,1232,341,1028,372,856,393,855,388,1027,367,1231,336,1268,329"/>
<area shape="rect" title=" " alt="" coords="1282,387,1351,412"/>
<area shape="poly" title=" " alt="" coords="1319,332,1319,373,1314,373,1314,332"/>
<area shape="poly" title=" " alt="" coords="781,178,784,372,779,373,776,178"/>
<area shape="poly" title=" " alt="" coords="747,180,628,223,626,218,746,175"/>
<area shape="poly" title=" " alt="" coords="844,175,1107,220,1106,226,843,180"/>
<area shape="poly" title=" " alt="" coords="780,177,785,213,792,233,805,249,840,267,888,279,946,286,1010,289,1135,291,1232,296,1256,301,1255,306,1231,301,1135,296,1009,294,946,291,887,284,838,272,802,253,788,235,780,215,775,178"/>
<area shape="rect" href="rbtree_8h.html" title="XWOS通用库：红黑树" alt="" coords="600,306,719,331"/>
<area shape="poly" title=" " alt="" coords="763,180,737,200,711,227,688,261,672,294,667,292,684,258,707,224,733,197,759,176"/>
<area shape="rect" href="i__allocator_8h.html" title="XWOS内存管理：内存池：分配器接口" alt="" coords="815,225,1026,251"/>
<area shape="poly" title=" " alt="" coords="802,175,886,217,884,221,800,180"/>
<area shape="poly" title=" " alt="" coords="679,329,754,377,751,381,676,334"/>
<area shape="poly" title=" " alt="" coords="902,253,872,273,841,300,814,338,795,375,790,373,810,336,837,297,868,269,899,249"/>
<area shape="poly" title=" " alt="" coords="983,248,1232,296,1253,300,1252,306,1231,301,982,253"/>
<area shape="poly" title=" " alt="" coords="940,102,980,128,1022,164,1038,185,1048,207,1050,230,1040,252,1023,270,1005,280,987,284,968,285,928,286,907,291,885,301,805,378,801,375,882,296,905,286,927,281,968,280,986,279,1004,275,1020,266,1036,249,1045,229,1043,209,1034,188,1018,168,977,132,937,106"/>
<area shape="poly" title=" " alt="" coords="833,107,464,156,463,151,833,101"/>
<area shape="poly" title=" " alt="" coords="829,107,753,124,715,138,678,154,636,184,603,216,599,213,632,180,675,150,713,133,752,119,828,101"/>
<area shape="poly" title=" " alt="" coords="962,102,1021,121,1083,150,1129,181,1166,213,1163,217,1126,185,1081,154,1019,126,961,107"/>
<area shape="poly" title=" " alt="" coords="1017,101,1084,116,1155,140,1224,175,1256,197,1284,224,1305,257,1315,291,1310,293,1300,259,1280,227,1252,202,1221,180,1153,145,1082,121,1016,107"/>
<area shape="poly" title=" " alt="" coords="897,106,814,148,812,143,894,102"/>
<area shape="poly" title=" " alt="" coords="921,104,923,212,918,212,916,105"/>
</map>
</div>
</div>
<p><a href="objcache_8c_source.html">浏览源代码.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
宏定义</h2></td></tr>
<tr class="memitem:a60823aba59fadea7895981b1b3c2f1ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a60823aba59fadea7895981b1b3c2f1ee">xwmm_mempoollogf</a>(lv,  thd,  fmt, ...)</td></tr>
<tr class="separator:a60823aba59fadea7895981b1b3c2f1ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:a75c1bbc6602c82f1cc906c65303ee59d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a75c1bbc6602c82f1cc906c65303ee59d">xwmm_mempool_objcache_page_init</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, struct <a class="el" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> *pg)</td></tr>
<tr class="memdesc:a75c1bbc6602c82f1cc906c65303ee59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">初始化新页  <br /></td></tr>
<tr class="separator:a75c1bbc6602c82f1cc906c65303ee59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21221e21cca4abbdfc36138c1cecb3f5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a21221e21cca4abbdfc36138c1cecb3f5">xwmm_mempool_objcache_free_idle_page</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> nr)</td></tr>
<tr class="memdesc:a21221e21cca4abbdfc36138c1cecb3f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">释放空闲页  <br /></td></tr>
<tr class="separator:a21221e21cca4abbdfc36138c1cecb3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6523b89f414d275f4c4548a684b21092"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a6523b89f414d275f4c4548a684b21092">xwmm_mempool_objcache_page_put</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, struct <a class="el" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> *pg)</td></tr>
<tr class="memdesc:a6523b89f414d275f4c4548a684b21092"><td class="mdescLeft">&#160;</td><td class="mdescRight">减少页的引用计数  <br /></td></tr>
<tr class="separator:a6523b89f414d275f4c4548a684b21092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e4915feeaf7a05d46ec2affe504642"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a23e4915feeaf7a05d46ec2affe504642">xwmm_mempool_objcache_page_get</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, struct <a class="el" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> **pgbuf)</td></tr>
<tr class="memdesc:a23e4915feeaf7a05d46ec2affe504642"><td class="mdescLeft">&#160;</td><td class="mdescRight">获取一页，准备从页内存中分配对象  <br /></td></tr>
<tr class="separator:a23e4915feeaf7a05d46ec2affe504642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27d6631115c7033bfb49d22d5d3d992d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a27d6631115c7033bfb49d22d5d3d992d">xwmm_mempool_objcache_i_a_malloc</a> (void *this, <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> size, void **membuf)</td></tr>
<tr class="memdesc:a27d6631115c7033bfb49d22d5d3d992d"><td class="mdescLeft">&#160;</td><td class="mdescRight">i_allocator接口函数：申请内存  <br /></td></tr>
<tr class="separator:a27d6631115c7033bfb49d22d5d3d992d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7214f0b448c3680b68f84d3bb6d7155a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="objcache_8c.html#a7214f0b448c3680b68f84d3bb6d7155a">xwmm_mempool_objcache_i_a_free</a> (void *this, void *mem)</td></tr>
<tr class="memdesc:a7214f0b448c3680b68f84d3bb6d7155a"><td class="mdescLeft">&#160;</td><td class="mdescRight">i_allocator接口函数：释放内存  <br /></td></tr>
<tr class="separator:a7214f0b448c3680b68f84d3bb6d7155a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga15d8fc6d72d2ef920927bd6702174c3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a">xwmm_mempool_objcache_init</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, struct <a class="el" href="structxwmm__mempool__page__allocator.html">xwmm_mempool_page_allocator</a> *pa, const char *name, <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> objsize, <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> alignment, <a class="el" href="group__xwos__lib__type.html#ga59fe68c80516b22de8dccb84275d23f2">xwsq_t</a> pg_order, <a class="el" href="group__xwos__lib__type.html#gaf7d6db44108764f9cbaea53c923d2736">ctor_f</a> ctor, <a class="el" href="group__xwos__lib__type.html#gafe80dfa42b558589ad7ebce2bea43946">dtor_f</a> dtor)</td></tr>
<tr class="memdesc:ga15d8fc6d72d2ef920927bd6702174c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">XWMM API：初始化对象缓存  <br /></td></tr>
<tr class="separator:ga15d8fc6d72d2ef920927bd6702174c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86e445faf7ecf95130e042fa9b96a41b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xwmm__mempool.html#ga86e445faf7ecf95130e042fa9b96a41b">xwmm_mempool_objcache_alloc</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, void **objbuf)</td></tr>
<tr class="memdesc:ga86e445faf7ecf95130e042fa9b96a41b"><td class="mdescLeft">&#160;</td><td class="mdescRight">XWMM API：从对象缓存中申请一个对象  <br /></td></tr>
<tr class="separator:ga86e445faf7ecf95130e042fa9b96a41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7d39e7ba00cc3926284e6ba8775121b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xwmm__mempool.html#gae7d39e7ba00cc3926284e6ba8775121b">xwmm_mempool_objcache_free</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, void *obj)</td></tr>
<tr class="memdesc:gae7d39e7ba00cc3926284e6ba8775121b"><td class="mdescLeft">&#160;</td><td class="mdescRight">XWMM API：释放对象到对象缓存中  <br /></td></tr>
<tr class="separator:gae7d39e7ba00cc3926284e6ba8775121b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa72ed546dbddbbb8dd035c01c6334a24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xwmm__mempool.html#gaa72ed546dbddbbb8dd035c01c6334a24">xwmm_mempool_objcache_reserve</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> reserved)</td></tr>
<tr class="memdesc:gaa72ed546dbddbbb8dd035c01c6334a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">XWMM API：预留对象到对象缓存中  <br /></td></tr>
<tr class="separator:gaa72ed546dbddbbb8dd035c01c6334a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab664530444050735173f9bc44c32ab14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xwmm__mempool.html#gab664530444050735173f9bc44c32ab14">xwmm_mempool_objcache_get_capacity</a> (struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *oc, <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> *capacity)</td></tr>
<tr class="memdesc:gab664530444050735173f9bc44c32ab14"><td class="mdescLeft">&#160;</td><td class="mdescRight">XWMM API：获取对象缓存的容量  <br /></td></tr>
<tr class="separator:gab664530444050735173f9bc44c32ab14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><p>XWOS内存管理：内存池：对象缓存 </p>
<dl class="section author"><dt>作者</dt><dd><ul>
<li>隐星魂 (Roy Sun) <a href="#" onclick="location.href='mai'+'lto:'+'xwo'+'s@'+'xwo'+'s.'+'tec'+'h'; return false;">xwos@<span class="obfuscator">.nosp@m.</span>xwos<span class="obfuscator">.nosp@m.</span>.tech</a> </li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>版权所有</dt><dd><ul>
<li>Copyright © 2015 xwos.tech, All Rights Reserved. <blockquote class="doxtable">
<p>&zwj;This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0. If a copy of the MPL was not distributed with this file, You can obtain one at <a href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>. </p>
</blockquote>
</li>
</ul>
</dd></dl>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 中定义.</p>
</div><h2 class="groupheader">宏定义说明</h2>
<a id="a60823aba59fadea7895981b1b3c2f1ee" name="a60823aba59fadea7895981b1b3c2f1ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60823aba59fadea7895981b1b3c2f1ee">&#9670;&#160;</a></span>xwmm_mempoollogf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define xwmm_mempoollogf</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">lv, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">thd, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; 调试日志开关 </p>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00028">28</a> 行定义.</p>

</div>
</div>
<h2 class="groupheader">函数说明</h2>
<a id="a21221e21cca4abbdfc36138c1cecb3f5" name="a21221e21cca4abbdfc36138c1cecb3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21221e21cca4abbdfc36138c1cecb3f5">&#9670;&#160;</a></span>xwmm_mempool_objcache_free_idle_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> xwmm_mempool_objcache_free_idle_page </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *&#160;</td>
          <td class="paramname"><em>oc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>&#160;</td>
          <td class="paramname"><em>nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>释放空闲页 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">oc</td><td>对象缓存的指针 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nr</td><td>期望释放的数量 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>实际释放的数量 </dd></dl>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00160">160</a> 行定义.</p>
<div class="fragment"><div class="line"><span class="lineno">  162</span>{</div>
<div class="line"><span class="lineno">  163</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> * pg;</div>
<div class="line"><span class="lineno">  164</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#gad21f70aa6f1364b63b1165784448bc16">xwreg_t</a> flag;</div>
<div class="line"><span class="lineno">  165</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> real;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        real = 0;</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">while</span> (real &lt; nr) {</div>
<div class="line"><span class="lineno">  169</span>                <a class="code hl_function" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb">xwos_sqlk_wr_lock_cpuirqsv</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, &amp;flag);</div>
<div class="line"><span class="lineno">  170</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62">xwlib_bclst_tst_empty</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a26d781cc1112808f876f0d2551da2d30">idle</a>)) {</div>
<div class="line"><span class="lineno">  171</span>                        <a class="code hl_function" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, flag);</div>
<div class="line"><span class="lineno">  172</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  173</span>                }</div>
<div class="line"><span class="lineno">  174</span>                pg = <a class="code hl_define" href="group__xwos__lib__bclst.html#gac19bef358525ab7d2c8c57685db99387">xwlib_bclst_last_entry</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a26d781cc1112808f876f0d2551da2d30">idle</a>,</div>
<div class="line"><span class="lineno">  175</span>                                            <span class="keyword">struct</span> <a class="code hl_struct" href="structxwmm__mempool__page.html">xwmm_mempool_page</a>,</div>
<div class="line"><span class="lineno">  176</span>                                            <a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.objcache.node);</div>
<div class="line"><span class="lineno">  177</span>                <a class="code hl_function" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae">xwlib_bclst_del_init</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  178</span>                <a class="code hl_function" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, flag);</div>
<div class="line"><span class="lineno">  179</span>                <span class="comment">// cppcheck-suppress [misra-c2012-17.7]</span></div>
<div class="line"><span class="lineno">  180</span>                <a class="code hl_function" href="group__xwmm__mempool.html#ga52f11e08dc37a0cc72717169b6ae4131">xwmm_mempool_page_free</a>(oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a053bc33ff6399770874b14c65bdb5390">pa</a>, pg);</div>
<div class="line"><span class="lineno">  181</span>                <a class="code hl_define" href="group__xwos__lib__xwaop.html#gae0b3f8bf7b0d30d78c73f24dbfde6273">xwaop_sub</a>(<a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>, &amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#afc8c3ae5d542f2a700f5b2ac17aed6d2">capacity</a>, oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">pg_objnr</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  182</span>                <a class="code hl_define" href="group__xwos__lib__xwaop.html#gae0b3f8bf7b0d30d78c73f24dbfde6273">xwaop_sub</a>(<a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>, &amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#aca5c7fbe77e4fc6836679fc6f4189c3d">idleness</a>, oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">pg_objnr</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  183</span>                real++;</div>
<div class="line"><span class="lineno">  184</span>        }</div>
<div class="line"><span class="lineno">  185</span>        <span class="keywordflow">return</span> real;</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="agroup__xwmm__mempool_html_ga52f11e08dc37a0cc72717169b6ae4131"><div class="ttname"><a href="group__xwmm__mempool.html#ga52f11e08dc37a0cc72717169b6ae4131">xwmm_mempool_page_free</a></div><div class="ttdeci">xwer_t xwmm_mempool_page_free(struct xwmm_mempool_page_allocator *pa, struct xwmm_mempool_page *pg)</div><div class="ttdoc">XWMM API：释放一页内存</div><div class="ttdef"><b>Definition</b> <a href="page_8c_source.html#l00194">page.c:194</a></div></div>
<div class="ttc" id="agroup__xwos__lib__bclst_html_ga54d0d6c4a04b8f3c80891f7d0f5a1e62"><div class="ttname"><a href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62">xwlib_bclst_tst_empty</a></div><div class="ttdeci">static bool xwlib_bclst_tst_empty(const struct xwlib_bclst_node *h)</div><div class="ttdoc">测试链表是否为空。</div><div class="ttdef"><b>Definition</b> <a href="bclst_8h_source.html#l00253">bclst.h:253</a></div></div>
<div class="ttc" id="agroup__xwos__lib__bclst_html_gab12f3ce1a4e53de3112b10c9ffb06cae"><div class="ttname"><a href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae">xwlib_bclst_del_init</a></div><div class="ttdeci">static void xwlib_bclst_del_init(struct xwlib_bclst_node *node)</div><div class="ttdoc">删除一个节点，并重新初始化它</div><div class="ttdef"><b>Definition</b> <a href="bclst_8h_source.html#l00391">bclst.h:391</a></div></div>
<div class="ttc" id="agroup__xwos__lib__bclst_html_gac19bef358525ab7d2c8c57685db99387"><div class="ttname"><a href="group__xwos__lib__bclst.html#gac19bef358525ab7d2c8c57685db99387">xwlib_bclst_last_entry</a></div><div class="ttdeci">#define xwlib_bclst_last_entry(head, type, member)</div><div class="ttdoc">获得包含链表最后一个节点的外层结构体的指针。</div><div class="ttdef"><b>Definition</b> <a href="bclst_8h_source.html#l00073">bclst.h:73</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_ga070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00028">type.h:28</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_ga2d00153ecb0cdcc8ea0823c13ee59649"><div class="ttname"><a href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a></div><div class="ttdeci">unsigned long xwsz_t</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00339">type.h:339</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_gad21f70aa6f1364b63b1165784448bc16"><div class="ttname"><a href="group__xwos__lib__type.html#gad21f70aa6f1364b63b1165784448bc16">xwreg_t</a></div><div class="ttdeci">xwptr_t xwreg_t</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00409">type.h:409</a></div></div>
<div class="ttc" id="agroup__xwos__lib__xwaop_html_gae0b3f8bf7b0d30d78c73f24dbfde6273"><div class="ttname"><a href="group__xwos__lib__xwaop.html#gae0b3f8bf7b0d30d78c73f24dbfde6273">xwaop_sub</a></div><div class="ttdeci">#define xwaop_sub(type, a, v, nv, ov)</div><div class="ttdoc">对原子变量进行原子操作：读取－相减－回写</div><div class="ttdef"><b>Definition</b> <a href="xwaop_8h_source.html#l00598">xwaop.h:598</a></div></div>
<div class="ttc" id="agroup__xwos__lock__seqlock_html_gabc138d69277ba1017ade0f27c6c282cb"><div class="ttname"><a href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb">xwos_sqlk_wr_lock_cpuirqsv</a></div><div class="ttdeci">static void xwos_sqlk_wr_lock_cpuirqsv(struct xwos_sqlk *sql, xwreg_t *cpuirq)</div><div class="ttdoc">XWOS API：开启写临界区，保存本地CPU的中断标志并关闭</div><div class="ttdef"><b>Definition</b> <a href="lock_2seqlock_8h_source.html#l00575">seqlock.h:575</a></div></div>
<div class="ttc" id="agroup__xwos__lock__seqlock_html_gadcb38d5d6dad7969e1231c47c131f3c8"><div class="ttname"><a href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a></div><div class="ttdeci">static void xwos_sqlk_wr_unlock_cpuirqrs(struct xwos_sqlk *sql, xwreg_t cpuirq)</div><div class="ttdoc">XWOS API：关闭写临界区，恢复本地CPU的中断标志</div><div class="ttdef"><b>Definition</b> <a href="lock_2seqlock_8h_source.html#l00608">seqlock.h:608</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_a053bc33ff6399770874b14c65bdb5390"><div class="ttname"><a href="structxwmm__mempool__objcache.html#a053bc33ff6399770874b14c65bdb5390">xwmm_mempool_objcache::pa</a></div><div class="ttdeci">struct xwmm_mempool_page_allocator * pa</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00036">objcache.h:36</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_a26d781cc1112808f876f0d2551da2d30"><div class="ttname"><a href="structxwmm__mempool__objcache.html#a26d781cc1112808f876f0d2551da2d30">xwmm_mempool_objcache::idle</a></div><div class="ttdeci">struct xwlib_bclst_node idle</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00057">objcache.h:57</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_a6d27d017089b61643a2248a048b26ef8"><div class="ttname"><a href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">xwmm_mempool_objcache::lock</a></div><div class="ttdeci">struct xwos_sqlk lock</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00058">objcache.h:58</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_abd4c454f4dd3f8389fd1ada1a2504d02"><div class="ttname"><a href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">xwmm_mempool_objcache::pg_objnr</a></div><div class="ttdeci">xwsz_t pg_objnr</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00041">objcache.h:41</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_aca5c7fbe77e4fc6836679fc6f4189c3d"><div class="ttname"><a href="structxwmm__mempool__objcache.html#aca5c7fbe77e4fc6836679fc6f4189c3d">xwmm_mempool_objcache::idleness</a></div><div class="ttdeci">atomic_xwsz_t idleness</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00051">objcache.h:51</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_af5710f3b100420dbdd54cfcb952877fc"><div class="ttname"><a href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">xwmm_mempool_objcache::page_list</a></div><div class="ttdeci">struct xwmm_mempool_objcache::@0 page_list</div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_afc8c3ae5d542f2a700f5b2ac17aed6d2"><div class="ttname"><a href="structxwmm__mempool__objcache.html#afc8c3ae5d542f2a700f5b2ac17aed6d2">xwmm_mempool_objcache::capacity</a></div><div class="ttdeci">atomic_xwsz_t capacity</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00050">objcache.h:50</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html"><div class="ttname"><a href="structxwmm__mempool__page.html">xwmm_mempool_page</a></div><div class="ttdoc">内存页</div><div class="ttdef"><b>Definition</b> <a href="page_8h_source.html#l00037">page.h:37</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_a12866c4340feabc2fade6a9d5a7dbb16"><div class="ttname"><a href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">xwmm_mempool_page::node</a></div><div class="ttdeci">struct xwlib_bclst_node node</div><div class="ttdef"><b>Definition</b> <a href="page_8h_source.html#l00051">page.h:51</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_a678e3535823e3eab676917331f622473"><div class="ttname"><a href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">xwmm_mempool_page::attr</a></div><div class="ttdeci">union xwmm_mempool_page::@1 attr</div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_adc80ae7e64a16dfabb3c173ba80fcd5a"><div class="ttname"><a href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">xwmm_mempool_page::objcache</a></div><div class="ttdeci">struct xwmm_mempool_page::@1::@4 objcache</div></div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_cgraph.png" border="0" usemap="#aobjcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_cgraph" alt=""/></div>
<map name="aobjcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_cgraph" id="aobjcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_cgraph">
<area shape="rect" title="释放空闲页" alt="" coords="5,238,185,278"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae" title="删除一个节点，并重新初始化它" alt="" coords="259,55,393,80"/>
<area shape="poly" title=" " alt="" coords="119,236,297,87,301,91,122,240"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62" title="测试链表是否为空。" alt="" coords="250,196,402,221"/>
<area shape="poly" title=" " alt="" coords="185,236,252,222,253,227,186,241"/>
<area shape="rect" href="group__xwmm__mempool.html#ga52f11e08dc37a0cc72717169b6ae4131" title="XWMM API：释放一页内存" alt="" coords="233,245,419,271"/>
<area shape="poly" title=" " alt="" coords="185,255,220,255,220,261,185,261"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb" title="XWOS API：开启写临界区，保存本地CPU的中断标志并关闭" alt="" coords="1013,300,1205,325"/>
<area shape="poly" title=" " alt="" coords="186,273,234,281,438,308,598,321,759,324,965,319,1000,318,1000,323,965,325,759,330,598,327,438,313,233,286,185,278"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8" title="XWOS API：关闭写临界区，恢复本地CPU的中断标志" alt="" coords="1034,350,1185,390"/>
<area shape="poly" title=" " alt="" coords="139,276,184,294,234,310,342,332,453,348,564,360,673,367,870,373,1020,371,1020,376,870,378,673,372,564,365,452,353,341,337,233,315,182,300,136,281"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab7918962f86f86d5c7049922a5173e81" title="删除prev节点与next节点之间的节点" alt="" coords="489,5,656,31"/>
<area shape="poly" title=" " alt="" coords="390,52,495,31,496,36,391,57"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569" title="初始化一个链表节点。" alt="" coords="499,55,646,80"/>
<area shape="poly" title=" " alt="" coords="393,65,486,65,486,70,393,70"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga528f2863f2774a2f948db55c73ce6ee7" title="初始化红黑树节点" alt="" coords="1034,33,1185,59"/>
<area shape="poly" title=" " alt="" coords="380,243,418,230,441,218,466,205,616,154,768,113,907,81,1020,59,1021,64,908,86,769,118,617,159,468,210,444,222,420,235,381,248"/>
<area shape="rect" href="page_8c.html#a8e9302d65eea335934b13f63caea64aa" title="合并空闲的伙伴页" alt="" coords="467,220,679,245"/>
<area shape="poly" title=" " alt="" coords="419,246,453,242,453,248,419,251"/>
<area shape="rect" href="page_8c.html#aeea41b96161d6bab8ed17f9df7dbb2f9" title="获取页的序列值" alt="" coords="468,269,677,295"/>
<area shape="poly" title=" " alt="" coords="419,264,455,268,454,273,419,270"/>
<area shape="rect" href="page_8c.html#aecba66f62c5f653b61e4dd01d92bcc6c" title="找到页的伙伴页" alt="" coords="755,270,937,310"/>
<area shape="poly" title=" " alt="" coords="635,243,742,266,741,271,634,248"/>
<area shape="rect" href="page_8c.html#adc418491ba0dd770fa96b845e96722d9" title="增加页到阶红黑树中" alt="" coords="727,220,965,245"/>
<area shape="poly" title=" " alt="" coords="679,230,713,230,713,235,679,235"/>
<area shape="rect" href="page_8c.html#a0803eb38a9059618cf4c98136dc70033" title="从阶红黑树中删除页" alt="" coords="741,155,951,195"/>
<area shape="poly" title=" " alt="" coords="634,217,736,196,737,201,635,223"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaa09f90f7792b00240a3cecef84946d88" title="插入一个红色节点后修正红黑树的颜色" alt="" coords="1044,134,1175,174"/>
<area shape="poly" title=" " alt="" coords="918,217,964,205,1012,184,1032,176,1034,181,1014,188,966,210,919,222"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaef7f6608cd37a0fb765adb003428ec38" title="链接节点，并设置位置及颜色信息" alt="" coords="1286,335,1405,360"/>
<area shape="poly" title=" " alt="" coords="966,235,1084,251,1147,266,1206,286,1221,295,1231,303,1255,321,1274,329,1272,334,1252,326,1228,308,1218,299,1204,291,1145,271,1083,256,965,240"/>
<area shape="poly" title=" " alt="" coords="920,243,966,255,991,266,1014,278,1055,293,1053,298,1012,283,988,271,964,261,918,248"/>
<area shape="poly" title=" " alt="" coords="943,243,967,256,985,276,992,296,999,317,1015,336,1023,342,1020,346,1012,340,995,319,987,298,980,278,964,260,941,248"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga3d27937625dc93286c012da5e82945b8" title="反转节点的颜色" alt="" coords="1270,137,1421,163"/>
<area shape="poly" title=" " alt="" coords="1175,150,1256,149,1257,154,1175,156"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga8e9025d3e8bade2a627001fb58251047" title="返回节点的父节点指针" alt="" coords="1265,88,1425,113"/>
<area shape="poly" title=" " alt="" coords="1174,137,1275,114,1276,119,1176,142"/>
<area shape="poly" title=" " alt="" coords="928,153,964,134,979,120,987,106,996,91,1012,76,1039,61,1042,66,1015,80,1000,94,992,109,983,124,967,139,931,158"/>
<area shape="poly" title=" " alt="" coords="908,153,1013,119,1137,103,1252,98,1252,103,1138,109,1014,125,909,158"/>
<area shape="poly" title=" " alt="" coords="937,193,967,205,1021,241,1083,289,1080,293,1018,246,964,210,935,198"/>
<area shape="poly" title=" " alt="" coords="950,193,967,205,981,222,988,239,992,272,996,305,1003,320,1015,336,1024,343,1021,348,1011,340,998,323,991,306,987,272,983,240,976,225,964,209,947,198"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gac57fdaeef6a9dc2ee2bedbf5ac885f96" title="删除一个节点，并修正红黑树的颜色" alt="" coords="1038,199,1181,224"/>
<area shape="poly" title=" " alt="" coords="952,187,1025,197,1024,202,951,192"/>
<area shape="poly" title=" " alt="" coords="1158,196,1282,164,1283,169,1160,201"/>
<area shape="poly" title=" " alt="" coords="1178,196,1204,184,1219,169,1227,154,1236,138,1252,123,1262,116,1265,121,1255,127,1240,141,1232,157,1223,173,1207,188,1181,201"/>
<area shape="poly" title=" " alt="" coords="1171,222,1207,241,1224,262,1232,283,1239,303,1255,321,1274,332,1272,337,1252,325,1234,305,1227,285,1219,265,1204,245,1168,226"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga2502fed0a895591911885bd8725de911" title="返回节点的后继节点" alt="" coords="1253,187,1437,212"/>
<area shape="poly" title=" " alt="" coords="1181,205,1239,202,1240,207,1181,210"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga692ff81d9c30fac79a823c5c2ff2357d" title="将节点设置为黑色" alt="" coords="1268,236,1423,261"/>
<area shape="poly" title=" " alt="" coords="1181,220,1255,232,1254,237,1180,225"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga7b281445f2079f235077400ee79f15ea" title="用新节点代替旧节点并继承它的链指针、颜色和位置信息， 但新节点并不接管旧节点的子节点" alt="" coords="1267,285,1423,311"/>
<area shape="poly" title=" " alt="" coords="1157,222,1207,241,1231,257,1255,272,1273,279,1271,284,1252,276,1228,261,1204,246,1155,227"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_icgraph.png" border="0" usemap="#aobjcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_icgraph" alt=""/></div>
<map name="aobjcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_icgraph" id="aobjcache_8c_a21221e21cca4abbdfc36138c1cecb3f5_icgraph">
<area shape="rect" title="释放空闲页" alt="" coords="1167,35,1347,75"/>
<area shape="rect" href="group__xwmm__mempool.html#gae7d39e7ba00cc3926284e6ba8775121b" title="XWMM API：释放对象到对象缓存中" alt="" coords="909,13,1119,38"/>
<area shape="poly" title=" " alt="" coords="1153,45,1119,41,1119,35,1153,40"/>
<area shape="rect" href="group__xwmm__mempool.html#gaa72ed546dbddbbb8dd035c01c6334a24" title="XWMM API：预留对象到对象缓存中" alt="" coords="924,63,1104,103"/>
<area shape="poly" title=" " alt="" coords="1153,69,1104,75,1104,70,1153,64"/>
<area shape="rect" href="objcache_8c.html#a7214f0b448c3680b68f84d3bb6d7155a" title="i_allocator接口函数：释放内存" alt="" coords="681,5,861,45"/>
<area shape="poly" title=" " alt="" coords="896,28,862,28,862,23,896,23"/>
<area shape="rect" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a" title="XWMM API：初始化对象缓存" alt="" coords="429,13,633,38"/>
<area shape="poly" title=" " alt="" coords="668,28,634,28,634,23,668,23"/>
<area shape="rect" href="allocator_8c.html#a6e1f6748cc378d09e931897b69231d0d" title="构建内存池" alt="" coords="199,13,381,38"/>
<area shape="poly" title=" " alt="" coords="416,28,382,28,382,23,416,23"/>
<area shape="rect" href="group__xwmm__mempool.html#gaad8340a12043c383e489a786788e89af" title="XWMM API：初始化内存池" alt="" coords="5,13,151,38"/>
<area shape="poly" title=" " alt="" coords="184,28,151,28,151,23,184,23"/>
</map>
</div>

</div>
</div>
<a id="a7214f0b448c3680b68f84d3bb6d7155a" name="a7214f0b448c3680b68f84d3bb6d7155a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7214f0b448c3680b68f84d3bb6d7155a">&#9670;&#160;</a></span>xwmm_mempool_objcache_i_a_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a> xwmm_mempool_objcache_i_a_free </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>mem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>i_allocator接口函数：释放内存 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>this指针(页分配器) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mem</td><td>内存的首地址 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>错误码 </dd></dl>
<dl class="retval"><dt>返回值</dt><dd>
  <table class="retval">
    <tr><td class="paramname">XWOK</td><td>没有错误 </td></tr>
    <tr><td class="paramname">-ENOMEM</td><td>内存不足 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00430">430</a> 行定义.</p>
<div class="fragment"><div class="line"><span class="lineno">  431</span>{</div>
<div class="line"><span class="lineno">  432</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> * oc;</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a> rc;</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>        oc = <span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  436</span>        rc = <a class="code hl_function" href="group__xwmm__mempool.html#gae7d39e7ba00cc3926284e6ba8775121b">xwmm_mempool_objcache_free</a>(oc, mem);</div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  438</span>}</div>
<div class="ttc" id="agroup__xwmm__mempool_html_gae7d39e7ba00cc3926284e6ba8775121b"><div class="ttname"><a href="group__xwmm__mempool.html#gae7d39e7ba00cc3926284e6ba8775121b">xwmm_mempool_objcache_free</a></div><div class="ttdeci">xwer_t xwmm_mempool_objcache_free(struct xwmm_mempool_objcache *oc, void *obj)</div><div class="ttdoc">XWMM API：释放对象到对象缓存中</div><div class="ttdef"><b>Definition</b> <a href="objcache_8c_source.html#l00299">objcache.c:299</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_ga06847ea8c7edb2b1f166288b230f251f"><div class="ttname"><a href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a></div><div class="ttdeci">signed long xwer_t</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00554">type.h:554</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html"><div class="ttname"><a href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a></div><div class="ttdoc">对象缓存</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00034">objcache.h:34</a></div></div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_cgraph.png" border="0" usemap="#aobjcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_cgraph" alt=""/></div>
<map name="aobjcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_cgraph" id="aobjcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_cgraph">
<area shape="rect" title="i_allocator接口函数：释放内存" alt="" coords="5,322,185,362"/>
<area shape="rect" href="group__xwmm__mempool.html#gae7d39e7ba00cc3926284e6ba8775121b" title="XWMM API：释放对象到对象缓存中" alt="" coords="233,329,443,355"/>
<area shape="poly" title=" " alt="" coords="185,339,219,339,219,345,185,345"/>
<area shape="rect" href="group__xwos__lib__lfq.html#ga1cac1b49ec185ccb135f19401e286166" title="将一个节点推入无锁队列（栈式队列）" alt="" coords="529,196,637,221"/>
<area shape="poly" title=" " alt="" coords="352,327,410,281,448,255,490,232,514,222,516,227,492,236,451,259,413,285,355,331"/>
<area shape="rect" href="objcache_8c.html#a21221e21cca4abbdfc36138c1cecb3f5" title="释放空闲页" alt="" coords="493,246,673,286"/>
<area shape="poly" title=" " alt="" coords="379,327,504,288,505,293,381,332"/>
<area shape="rect" href="objcache_8c.html#a6523b89f414d275f4c4548a684b21092" title="减少页的引用计数" alt="" coords="493,397,673,437"/>
<area shape="poly" title=" " alt="" coords="382,352,504,390,502,395,380,357"/>
<area shape="rect" href="group__xwmm__mempool.html#gac5da9c9562774fdac8cda7f769d60967" title="依据内存地址查找页" alt="" coords="491,508,675,533"/>
<area shape="poly" title=" " alt="" coords="358,353,555,498,551,502,355,357"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae" title="删除一个节点，并重新初始化它" alt="" coords="761,328,895,353"/>
<area shape="poly" title=" " alt="" coords="650,283,773,321,772,327,648,289"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62" title="测试链表是否为空。" alt="" coords="752,153,904,179"/>
<area shape="poly" title=" " alt="" coords="647,244,673,230,687,220,696,209,706,198,721,188,738,180,740,185,724,192,710,202,700,213,691,224,676,235,649,248"/>
<area shape="rect" href="group__xwmm__mempool.html#ga52f11e08dc37a0cc72717169b6ae4131" title="XWMM API：释放一页内存" alt="" coords="735,203,921,228"/>
<area shape="poly" title=" " alt="" coords="672,245,752,228,753,233,674,250"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb" title="XWOS API：开启写临界区，保存本地CPU的中断标志并关闭" alt="" coords="1528,359,1720,384"/>
<area shape="poly" title=" " alt="" coords="673,259,803,255,954,256,1095,265,1152,275,1195,289,1211,302,1220,317,1228,331,1243,342,1309,367,1380,379,1450,384,1514,382,1514,387,1450,389,1380,385,1308,372,1240,347,1224,334,1215,319,1207,305,1192,294,1151,280,1094,271,954,261,803,260,673,264"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8" title="XWOS API：关闭写临界区，恢复本地CPU的中断标志" alt="" coords="1549,179,1699,219"/>
<area shape="poly" title=" " alt="" coords="654,244,673,231,683,219,689,208,694,184,701,160,709,148,721,138,751,125,788,115,878,104,987,105,1105,113,1227,127,1344,144,1536,179,1535,184,1343,149,1226,132,1105,118,986,110,879,110,789,120,753,130,724,143,713,152,706,162,699,185,694,210,687,222,676,235,657,248"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab7918962f86f86d5c7049922a5173e81" title="删除prev节点与next节点之间的节点" alt="" coords="1004,353,1171,379"/>
<area shape="poly" title=" " alt="" coords="896,345,991,354,990,359,895,350"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569" title="初始化一个链表节点。" alt="" coords="1014,304,1161,329"/>
<area shape="poly" title=" " alt="" coords="895,332,1000,322,1001,327,896,337"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga528f2863f2774a2f948db55c73ce6ee7" title="初始化红黑树节点" alt="" coords="1549,29,1699,55"/>
<area shape="poly" title=" " alt="" coords="903,200,932,188,946,176,955,164,965,151,980,138,1049,103,1123,77,1199,57,1275,44,1348,36,1418,32,1535,33,1535,38,1418,38,1349,41,1275,49,1200,62,1124,82,1051,108,983,143,968,155,960,167,950,180,935,192,905,205"/>
<area shape="rect" href="page_8c.html#a8e9302d65eea335934b13f63caea64aa" title="合并空闲的伙伴页" alt="" coords="981,153,1193,179"/>
<area shape="poly" title=" " alt="" coords="895,200,1006,179,1007,184,896,205"/>
<area shape="rect" href="page_8c.html#aeea41b96161d6bab8ed17f9df7dbb2f9" title="获取页的序列值" alt="" coords="983,203,1192,228"/>
<area shape="poly" title=" " alt="" coords="921,213,969,213,969,218,921,218"/>
<area shape="rect" href="page_8c.html#aecba66f62c5f653b61e4dd01d92bcc6c" title="找到页的伙伴页" alt="" coords="1270,193,1451,233"/>
<area shape="poly" title=" " alt="" coords="1163,176,1257,192,1256,198,1162,181"/>
<area shape="rect" href="page_8c.html#adc418491ba0dd770fa96b845e96722d9" title="增加页到阶红黑树中" alt="" coords="1241,308,1480,333"/>
<area shape="poly" title=" " alt="" coords="1170,176,1195,188,1211,201,1221,214,1230,228,1243,243,1285,274,1325,299,1322,304,1281,278,1240,247,1225,231,1216,217,1207,204,1192,192,1167,181"/>
<area shape="rect" href="page_8c.html#a0803eb38a9059618cf4c98136dc70033" title="从阶红黑树中删除页" alt="" coords="1255,78,1466,118"/>
<area shape="poly" title=" " alt="" coords="1139,151,1266,119,1267,124,1140,156"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaa09f90f7792b00240a3cecef84946d88" title="插入一个红色节点后修正红黑树的颜色" alt="" coords="1559,243,1689,283"/>
<area shape="poly" title=" " alt="" coords="1419,305,1545,278,1546,283,1420,311"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaef7f6608cd37a0fb765adb003428ec38" title="链接节点，并设置位置及颜色信息" alt="" coords="1801,268,1919,293"/>
<area shape="poly" title=" " alt="" coords="1480,311,1720,293,1786,286,1787,291,1720,298,1480,316"/>
<area shape="poly" title=" " alt="" coords="1428,331,1544,353,1543,359,1427,336"/>
<area shape="poly" title=" " alt="" coords="1435,306,1479,286,1493,273,1502,259,1511,244,1526,229,1536,223,1539,228,1530,233,1515,247,1506,262,1498,276,1481,291,1437,310"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga3d27937625dc93286c012da5e82945b8" title="反转节点的颜色" alt="" coords="1785,153,1935,179"/>
<area shape="poly" title=" " alt="" coords="1688,243,1719,229,1733,219,1742,209,1752,198,1767,188,1782,181,1784,186,1769,192,1755,202,1746,212,1736,223,1721,234,1691,248"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga8e9025d3e8bade2a627001fb58251047" title="返回节点的父节点指针" alt="" coords="1780,203,1940,228"/>
<area shape="poly" title=" " alt="" coords="1689,247,1783,228,1784,233,1690,253"/>
<area shape="poly" title=" " alt="" coords="1455,75,1550,55,1551,60,1456,81"/>
<area shape="poly" title=" " alt="" coords="1467,109,1590,130,1721,165,1745,176,1769,188,1795,196,1794,201,1767,192,1743,181,1719,170,1588,136,1466,114"/>
<area shape="poly" title=" " alt="" coords="1403,116,1444,143,1482,179,1500,210,1507,237,1514,264,1530,294,1560,325,1592,349,1588,353,1556,329,1526,297,1509,266,1502,238,1495,212,1478,182,1441,147,1400,121"/>
<area shape="poly" title=" " alt="" coords="1430,116,1481,134,1529,158,1560,172,1558,176,1527,163,1479,139,1428,121"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gac57fdaeef6a9dc2ee2bedbf5ac885f96" title="删除一个节点，并修正红黑树的颜色" alt="" coords="1553,79,1695,104"/>
<area shape="poly" title=" " alt="" coords="1466,93,1539,91,1539,96,1466,98"/>
<area shape="poly" title=" " alt="" coords="1664,102,1721,121,1769,138,1798,147,1797,152,1767,143,1719,126,1663,107"/>
<area shape="poly" title=" " alt="" coords="1683,102,1722,121,1738,138,1746,156,1754,172,1770,188,1781,195,1779,199,1766,192,1750,175,1741,158,1733,141,1718,125,1681,106"/>
<area shape="poly" title=" " alt="" coords="1646,102,1683,129,1722,166,1737,186,1745,203,1754,220,1770,237,1807,260,1805,265,1766,241,1750,223,1740,206,1732,188,1718,169,1679,134,1643,106"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga2502fed0a895591911885bd8725de911" title="返回节点的后继节点" alt="" coords="1768,5,1952,31"/>
<area shape="poly" title=" " alt="" coords="1680,76,1719,64,1767,40,1790,32,1791,37,1769,44,1721,68,1681,81"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga692ff81d9c30fac79a823c5c2ff2357d" title="将节点设置为黑色" alt="" coords="1783,55,1937,80"/>
<area shape="poly" title=" " alt="" coords="1695,81,1769,74,1769,79,1696,87"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga7b281445f2079f235077400ee79f15ea" title="用新节点代替旧节点并继承它的链指针、颜色和位置信息， 但新节点并不接管旧节点的子节点" alt="" coords="1782,104,1938,129"/>
<area shape="poly" title=" " alt="" coords="1696,96,1769,104,1768,110,1695,102"/>
<area shape="poly" title=" " alt="" coords="648,394,772,355,774,360,649,399"/>
<area shape="poly" title=" " alt="" coords="673,428,723,433,855,441,958,444,1061,441,1193,433,1383,411,1544,384,1545,389,1384,416,1194,438,1061,446,958,449,855,446,722,438,673,433"/>
<area shape="poly" title=" " alt="" coords="673,421,805,427,957,428,1031,424,1097,417,1152,405,1192,388,1203,378,1210,367,1216,343,1221,318,1228,305,1240,293,1271,273,1299,261,1327,255,1353,253,1410,252,1443,249,1479,242,1550,221,1552,226,1481,247,1444,255,1411,258,1354,258,1327,260,1301,266,1273,278,1243,297,1232,308,1226,320,1221,344,1215,369,1207,382,1195,392,1154,410,1098,422,1031,429,957,433,805,433,673,426"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga942be8d64e19cb8efb4dd1cf10e6e706" title="将一个节点加入链表头部（链表头的后面）" alt="" coords="753,505,903,531"/>
<area shape="poly" title=" " alt="" coords="621,434,724,484,767,499,766,504,722,488,619,439"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga42c09bc0da5cac8327003314056f43b7" title="将一个新节点加入到prev与next之间" alt="" coords="1002,505,1173,531"/>
<area shape="poly" title=" " alt="" coords="904,515,988,515,988,521,904,521"/>
<area shape="rect" href="page_8c.html#a601e0e3ff8fc5ad5b7348046b545062e" title="从页内存地址获得其页控制块的指针" alt="" coords="723,555,933,580"/>
<area shape="poly" title=" " alt="" coords="651,531,748,549,747,555,650,536"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_icgraph.png" border="0" usemap="#aobjcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_icgraph" alt=""/></div>
<map name="aobjcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_icgraph" id="aobjcache_8c_a7214f0b448c3680b68f84d3bb6d7155a_icgraph">
<area shape="rect" title="i_allocator接口函数：释放内存" alt="" coords="681,5,861,45"/>
<area shape="rect" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a" title="XWMM API：初始化对象缓存" alt="" coords="429,13,633,38"/>
<area shape="poly" title=" " alt="" coords="668,28,634,28,634,23,668,23"/>
<area shape="rect" href="allocator_8c.html#a6e1f6748cc378d09e931897b69231d0d" title="构建内存池" alt="" coords="199,13,381,38"/>
<area shape="poly" title=" " alt="" coords="416,28,382,28,382,23,416,23"/>
<area shape="rect" href="group__xwmm__mempool.html#gaad8340a12043c383e489a786788e89af" title="XWMM API：初始化内存池" alt="" coords="5,13,151,38"/>
<area shape="poly" title=" " alt="" coords="184,28,151,28,151,23,184,23"/>
</map>
</div>

</div>
</div>
<a id="a27d6631115c7033bfb49d22d5d3d992d" name="a27d6631115c7033bfb49d22d5d3d992d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27d6631115c7033bfb49d22d5d3d992d">&#9670;&#160;</a></span>xwmm_mempool_objcache_i_a_malloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a> xwmm_mempool_objcache_i_a_malloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>membuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>i_allocator接口函数：申请内存 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>this指针(页分配器) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>申请的大小 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">membuf</td><td>指向缓冲区的指针，通过此缓冲区返回申请到的内存的首地址 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>错误码 </dd></dl>
<dl class="retval"><dt>返回值</dt><dd>
  <table class="retval">
    <tr><td class="paramname">XWOK</td><td>没有错误 </td></tr>
    <tr><td class="paramname">-ENOMEM</td><td>内存不足 </td></tr>
  </table>
  </dd>
</dl>
<p>&lt;Size error</p>
<p>&lt;No error</p>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00400">400</a> 行定义.</p>
<div class="fragment"><div class="line"><span class="lineno">  401</span>{</div>
<div class="line"><span class="lineno">  402</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> * oc;</div>
<div class="line"><span class="lineno">  403</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a> rc;</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>        oc = <span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">if</span> (size &gt; oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a05389bc2c128416b3fa0b43671168b40">objsize</a>) {</div>
<div class="line"><span class="lineno">  407</span>                rc = -<a class="code hl_define" href="group__xwos__lib__errno.html#gacb09eefda9ef228712245d1104fe9c89">ESIZE</a>;</div>
<div class="line"><span class="lineno">  408</span>                <span class="keywordflow">goto</span> err_size;</div>
<div class="line"><span class="lineno">  409</span>        }</div>
<div class="line"><span class="lineno">  410</span>        rc = <a class="code hl_function" href="group__xwmm__mempool.html#ga86e445faf7ecf95130e042fa9b96a41b">xwmm_mempool_objcache_alloc</a>(oc, membuf);</div>
<div class="line"><span class="lineno">  411</span>        <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><span class="lineno">  412</span>                <span class="keywordflow">goto</span> err_alloc;</div>
<div class="line"><span class="lineno">  413</span>        }</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="group__xwos__lib__errno.html#ga6a72d49d869215a02342eb465166537b">XWOK</a>;</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>err_alloc:</div>
<div class="line"><span class="lineno">  417</span>err_size:</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  419</span>}</div>
<div class="ttc" id="agroup__xwmm__mempool_html_ga86e445faf7ecf95130e042fa9b96a41b"><div class="ttname"><a href="group__xwmm__mempool.html#ga86e445faf7ecf95130e042fa9b96a41b">xwmm_mempool_objcache_alloc</a></div><div class="ttdeci">xwer_t xwmm_mempool_objcache_alloc(struct xwmm_mempool_objcache *oc, void **objbuf)</div><div class="ttdoc">XWMM API：从对象缓存中申请一个对象</div><div class="ttdef"><b>Definition</b> <a href="objcache_8c_source.html#l00263">objcache.c:263</a></div></div>
<div class="ttc" id="agroup__xwos__lib__errno_html_ga6a72d49d869215a02342eb465166537b"><div class="ttname"><a href="group__xwos__lib__errno.html#ga6a72d49d869215a02342eb465166537b">XWOK</a></div><div class="ttdeci">#define XWOK</div><div class="ttdoc">No error</div><div class="ttdef"><b>Definition</b> <a href="errno_8h_source.html#l00182">errno.h:182</a></div></div>
<div class="ttc" id="agroup__xwos__lib__errno_html_gacb09eefda9ef228712245d1104fe9c89"><div class="ttname"><a href="group__xwos__lib__errno.html#gacb09eefda9ef228712245d1104fe9c89">ESIZE</a></div><div class="ttdeci">#define ESIZE</div><div class="ttdoc">Size error</div><div class="ttdef"><b>Definition</b> <a href="errno_8h_source.html#l00202">errno.h:202</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_a05389bc2c128416b3fa0b43671168b40"><div class="ttname"><a href="structxwmm__mempool__objcache.html#a05389bc2c128416b3fa0b43671168b40">xwmm_mempool_objcache::objsize</a></div><div class="ttdeci">xwsz_t objsize</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00038">objcache.h:38</a></div></div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a27d6631115c7033bfb49d22d5d3d992d_cgraph.png" border="0" usemap="#aobjcache_8c_a27d6631115c7033bfb49d22d5d3d992d_cgraph" alt=""/></div>
<map name="aobjcache_8c_a27d6631115c7033bfb49d22d5d3d992d_cgraph" id="aobjcache_8c_a27d6631115c7033bfb49d22d5d3d992d_cgraph">
<area shape="rect" title="i_allocator接口函数：申请内存" alt="" coords="5,202,185,242"/>
<area shape="rect" href="group__xwmm__mempool.html#ga86e445faf7ecf95130e042fa9b96a41b" title="XWMM API：从对象缓存中申请一个对象" alt="" coords="233,202,413,242"/>
<area shape="poly" title=" " alt="" coords="186,219,220,219,220,225,186,225"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga942be8d64e19cb8efb4dd1cf10e6e706" title="将一个节点加入链表头部（链表头的后面）" alt="" coords="476,9,627,35"/>
<area shape="poly" title=" " alt="" coords="334,200,382,128,418,86,460,50,483,38,486,42,463,55,422,90,386,131,338,203"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga2aa317fe5cea0989c273b3c69f69d795" title="将一个节点加入链表尾部（链表头的前面）" alt="" coords="482,65,621,91"/>
<area shape="poly" title=" " alt="" coords="348,200,399,161,460,120,508,94,510,99,463,124,402,165,351,204"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae" title="删除一个节点，并重新初始化它" alt="" coords="726,55,861,80"/>
<area shape="poly" title=" " alt="" coords="374,199,515,146,689,89,719,81,720,86,690,94,516,152,376,204"/>
<area shape="rect" href="group__xwos__lib__lfq.html#gacbe43c237a9c7c6f21baa98daaf49e68" title="弹出无锁队列中的第一个节点（栈式队列）" alt="" coords="501,497,602,523"/>
<area shape="poly" title=" " alt="" coords="333,241,348,289,374,352,412,418,436,449,463,476,489,492,486,496,460,480,432,452,408,421,369,354,343,291,327,243"/>
<area shape="rect" href="objcache_8c.html#a23e4915feeaf7a05d46ec2affe504642" title="获取一页，准备从页内存中分配对象" alt="" coords="461,202,641,242"/>
<area shape="poly" title=" " alt="" coords="414,219,448,219,448,225,414,225"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb" title="XWOS API：开启写临界区，保存本地CPU的中断标志并关闭" alt="" coords="1512,173,1704,199"/>
<area shape="poly" title=" " alt="" coords="399,239,462,251,662,276,819,287,976,284,1177,267,1279,254,1379,236,1544,199,1546,205,1380,241,1279,259,1178,273,976,289,819,292,662,281,461,257,398,245"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8" title="XWOS API：关闭写临界区，恢复本地CPU的中断标志" alt="" coords="1533,490,1683,530"/>
<area shape="poly" title=" " alt="" coords="348,240,417,298,466,334,522,370,585,403,651,431,721,450,792,457,1063,457,1187,460,1312,470,1520,494,1519,499,1311,475,1187,466,1063,462,792,462,720,455,650,436,582,408,520,375,463,338,414,302,344,244"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga42c09bc0da5cac8327003314056f43b7" title="将一个新节点加入到prev与next之间" alt="" coords="708,5,879,31"/>
<area shape="poly" title=" " alt="" coords="627,18,694,17,694,22,627,23"/>
<area shape="poly" title=" " alt="" coords="599,63,689,39,723,31,724,36,690,45,601,68"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab7918962f86f86d5c7049922a5173e81" title="删除prev节点与next节点之间的节点" alt="" coords="978,33,1145,59"/>
<area shape="poly" title=" " alt="" coords="861,59,964,51,965,56,861,65"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569" title="初始化一个链表节点。" alt="" coords="988,83,1135,108"/>
<area shape="poly" title=" " alt="" coords="861,72,975,84,974,89,861,77"/>
<area shape="poly" title=" " alt="" coords="585,200,613,180,639,158,653,139,661,122,670,105,688,89,711,77,714,82,691,94,675,109,666,124,658,142,643,161,616,185,588,204"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62" title="测试链表是否为空。" alt="" coords="717,104,869,129"/>
<area shape="poly" title=" " alt="" coords="585,199,633,173,688,146,730,131,732,136,690,151,635,177,587,204"/>
<area shape="rect" href="objcache_8c.html#a75c1bbc6602c82f1cc906c65303ee59d" title="初始化新页" alt="" coords="703,205,883,245"/>
<area shape="poly" title=" " alt="" coords="641,220,690,221,690,226,641,226"/>
<area shape="rect" href="group__xwmm__mempool.html#ga7cbe7d0a7d7052c887dc7723c5010ec1" title="XWMM API：申请一页内存" alt="" coords="689,335,897,360"/>
<area shape="poly" title=" " alt="" coords="592,240,757,326,754,330,590,244"/>
<area shape="poly" title=" " alt="" coords="637,199,689,190,800,177,913,168,1138,162,1340,166,1498,174,1498,180,1339,171,1138,167,914,173,800,182,690,195,638,205"/>
<area shape="poly" title=" " alt="" coords="567,241,616,306,650,341,691,370,743,397,797,421,910,459,1027,486,1142,503,1253,513,1356,517,1519,514,1519,519,1355,522,1253,518,1142,508,1026,491,909,464,795,426,740,402,688,375,647,345,612,310,563,244"/>
<area shape="poly" title=" " alt="" coords="835,202,1020,112,1023,117,837,207"/>
<area shape="rect" href="group__xwos__lib__lfq.html#gac87b1137608605a80577abed410ddc1a" title="初始化无锁队列节点" alt="" coords="1013,184,1110,209"/>
<area shape="poly" title=" " alt="" coords="883,213,998,200,999,206,884,218"/>
<area shape="rect" href="group__xwos__lib__lfq.html#ga1cac1b49ec185ccb135f19401e286166" title="将一个节点推入无锁队列（栈式队列）" alt="" coords="1007,233,1115,259"/>
<area shape="poly" title=" " alt="" coords="884,229,994,238,993,243,883,234"/>
<area shape="rect" href="page_8c.html#a6385524c294a6af40c2ea0ff315d60fd" title="将大的页拆分成小的页" alt="" coords="945,335,1177,360"/>
<area shape="poly" title=" " alt="" coords="898,345,932,345,932,350,898,350"/>
<area shape="rect" href="page_8c.html#ab54f23d0058e1bff33377fc2d7b0a48c" title="从阶红黑树中选择一页" alt="" coords="1239,382,1450,422"/>
<area shape="poly" title=" " alt="" coords="862,357,946,370,1091,384,1226,394,1225,399,1091,390,945,375,862,363"/>
<area shape="rect" href="page_8c.html#adc418491ba0dd770fa96b845e96722d9" title="增加页到阶红黑树中" alt="" coords="1225,332,1464,357"/>
<area shape="poly" title=" " alt="" coords="1178,344,1211,343,1211,349,1178,349"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaa09f90f7792b00240a3cecef84946d88" title="插入一个红色节点后修正红黑树的颜色" alt="" coords="1543,325,1673,365"/>
<area shape="poly" title=" " alt="" coords="1464,342,1529,342,1529,347,1464,347"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaef7f6608cd37a0fb765adb003428ec38" title="链接节点，并设置位置及颜色信息" alt="" coords="1785,156,1903,181"/>
<area shape="poly" title=" " alt="" coords="1417,329,1463,310,1477,298,1486,286,1495,273,1511,260,1561,236,1604,226,1649,220,1703,207,1751,190,1778,182,1779,187,1753,195,1705,213,1650,226,1605,232,1563,241,1513,264,1499,276,1490,289,1481,302,1465,315,1419,334"/>
<area shape="poly" title=" " alt="" coords="1427,330,1462,311,1480,288,1486,265,1492,240,1510,216,1532,202,1535,206,1514,220,1497,243,1491,266,1484,291,1466,315,1430,334"/>
<area shape="poly" title=" " alt="" coords="1437,355,1465,368,1482,381,1492,395,1514,426,1573,479,1570,483,1510,429,1488,398,1478,385,1463,372,1435,360"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga3d27937625dc93286c012da5e82945b8" title="反转节点的颜色" alt="" coords="1769,353,1919,379"/>
<area shape="poly" title=" " alt="" coords="1674,348,1755,355,1755,361,1673,353"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga8e9025d3e8bade2a627001fb58251047" title="返回节点的父节点指针" alt="" coords="1764,403,1924,428"/>
<area shape="poly" title=" " alt="" coords="1669,362,1753,389,1780,397,1779,402,1751,394,1667,367"/>
<area shape="poly" title=" " alt="" coords="1451,418,1512,425,1608,428,1704,425,1750,422,1751,427,1704,430,1608,434,1512,430,1450,423"/>
<area shape="poly" title=" " alt="" coords="1445,380,1462,368,1481,343,1488,318,1494,291,1510,260,1540,229,1573,204,1576,208,1544,233,1514,264,1499,293,1494,319,1486,346,1466,372,1448,384"/>
<area shape="poly" title=" " alt="" coords="1418,420,1465,438,1490,453,1513,469,1541,482,1539,487,1511,474,1487,458,1463,443,1416,425"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga528f2863f2774a2f948db55c73ce6ee7" title="初始化红黑树节点" alt="" coords="1533,389,1683,415"/>
<area shape="poly" title=" " alt="" coords="1450,399,1519,399,1519,405,1450,405"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gac57fdaeef6a9dc2ee2bedbf5ac885f96" title="删除一个节点，并修正红黑树的颜色" alt="" coords="1537,275,1679,300"/>
<area shape="poly" title=" " alt="" coords="1440,380,1462,368,1477,354,1486,340,1495,325,1510,310,1525,303,1527,307,1514,315,1499,328,1490,343,1481,358,1466,372,1442,384"/>
<area shape="poly" title=" " alt="" coords="1668,298,1705,310,1729,324,1753,338,1776,347,1774,352,1751,343,1727,329,1703,315,1666,303"/>
<area shape="poly" title=" " alt="" coords="1681,297,1706,311,1723,331,1730,351,1738,371,1754,389,1761,394,1758,399,1750,393,1733,374,1725,353,1718,333,1702,315,1678,302"/>
<area shape="poly" title=" " alt="" coords="1664,272,1702,253,1717,238,1725,222,1734,206,1750,190,1771,180,1773,185,1754,195,1738,209,1730,225,1722,241,1706,257,1666,277"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga2502fed0a895591911885bd8725de911" title="返回节点的后继节点" alt="" coords="1752,304,1936,329"/>
<area shape="poly" title=" " alt="" coords="1680,293,1739,301,1738,306,1679,299"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga692ff81d9c30fac79a823c5c2ff2357d" title="将节点设置为黑色" alt="" coords="1767,205,1921,231"/>
<area shape="poly" title=" " alt="" coords="1647,272,1751,239,1779,232,1780,237,1753,245,1649,277"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga7b281445f2079f235077400ee79f15ea" title="用新节点代替旧节点并继承它的链指针、颜色和位置信息， 但新节点并不接管旧节点的子节点" alt="" coords="1766,255,1922,280"/>
<area shape="poly" title=" " alt="" coords="1679,279,1752,272,1753,278,1680,284"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a27d6631115c7033bfb49d22d5d3d992d_icgraph.png" border="0" usemap="#aobjcache_8c_a27d6631115c7033bfb49d22d5d3d992d_icgraph" alt=""/></div>
<map name="aobjcache_8c_a27d6631115c7033bfb49d22d5d3d992d_icgraph" id="aobjcache_8c_a27d6631115c7033bfb49d22d5d3d992d_icgraph">
<area shape="rect" title="i_allocator接口函数：申请内存" alt="" coords="681,5,861,45"/>
<area shape="rect" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a" title="XWMM API：初始化对象缓存" alt="" coords="429,13,633,38"/>
<area shape="poly" title=" " alt="" coords="668,28,634,28,634,23,668,23"/>
<area shape="rect" href="allocator_8c.html#a6e1f6748cc378d09e931897b69231d0d" title="构建内存池" alt="" coords="199,13,381,38"/>
<area shape="poly" title=" " alt="" coords="416,28,382,28,382,23,416,23"/>
<area shape="rect" href="group__xwmm__mempool.html#gaad8340a12043c383e489a786788e89af" title="XWMM API：初始化内存池" alt="" coords="5,13,151,38"/>
<area shape="poly" title=" " alt="" coords="184,28,151,28,151,23,184,23"/>
</map>
</div>

</div>
</div>
<a id="a23e4915feeaf7a05d46ec2affe504642" name="a23e4915feeaf7a05d46ec2affe504642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e4915feeaf7a05d46ec2affe504642">&#9670;&#160;</a></span>xwmm_mempool_objcache_page_get()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a> xwmm_mempool_objcache_page_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *&#160;</td>
          <td class="paramname"><em>oc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> **&#160;</td>
          <td class="paramname"><em>pgbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>获取一页，准备从页内存中分配对象 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">oc</td><td>对象缓存的指针 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pgbuf</td><td>指向缓冲区的指针，通过此缓冲区返回页控制块的指针 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>错误码 </dd></dl>
<dl class="retval"><dt>返回值</dt><dd>
  <table class="retval">
    <tr><td class="paramname">XWOK</td><td>没有错误 </td></tr>
    <tr><td class="paramname">-ENOMEM</td><td>内存不足 </td></tr>
  </table>
  </dd>
</dl>
<p>&lt;No error</p>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00225">225</a> 行定义.</p>
<div class="fragment"><div class="line"><span class="lineno">  227</span>{</div>
<div class="line"><span class="lineno">  228</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> * pg;</div>
<div class="line"><span class="lineno">  229</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#gad21f70aa6f1364b63b1165784448bc16">xwreg_t</a> flag;</div>
<div class="line"><span class="lineno">  230</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#ga06847ea8c7edb2b1f166288b230f251f">xwer_t</a> rc;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        <a class="code hl_function" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb">xwos_sqlk_wr_lock_cpuirqsv</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, &amp;flag);</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62">xwlib_bclst_tst_empty</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#aa90dcd466fd2d2df7008925e664d277d">available</a>)) {</div>
<div class="line"><span class="lineno">  234</span>                pg = <a class="code hl_define" href="group__xwos__lib__bclst.html#gaf6605d963c470c23c3031a450144d119">xwlib_bclst_first_entry</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#aa90dcd466fd2d2df7008925e664d277d">available</a>,</div>
<div class="line"><span class="lineno">  235</span>                                             <span class="keyword">struct</span> <a class="code hl_struct" href="structxwmm__mempool__page.html">xwmm_mempool_page</a>,</div>
<div class="line"><span class="lineno">  236</span>                                             <a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.objcache.node);</div>
<div class="line"><span class="lineno">  237</span>                <a class="code hl_function" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae">xwlib_bclst_del_init</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  238</span>                <a class="code hl_function" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, flag);</div>
<div class="line"><span class="lineno">  239</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62">xwlib_bclst_tst_empty</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a26d781cc1112808f876f0d2551da2d30">idle</a>)) {</div>
<div class="line"><span class="lineno">  240</span>                pg = <a class="code hl_define" href="group__xwos__lib__bclst.html#gaf6605d963c470c23c3031a450144d119">xwlib_bclst_first_entry</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a26d781cc1112808f876f0d2551da2d30">idle</a>,</div>
<div class="line"><span class="lineno">  241</span>                                             <span class="keyword">struct</span> <a class="code hl_struct" href="structxwmm__mempool__page.html">xwmm_mempool_page</a>,</div>
<div class="line"><span class="lineno">  242</span>                                             <a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.objcache.node);</div>
<div class="line"><span class="lineno">  243</span>                <a class="code hl_function" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae">xwlib_bclst_del_init</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  244</span>                <a class="code hl_function" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, flag);</div>
<div class="line"><span class="lineno">  245</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  246</span>                <a class="code hl_function" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, flag);</div>
<div class="line"><span class="lineno">  247</span>                rc = <a class="code hl_function" href="group__xwmm__mempool.html#ga7cbe7d0a7d7052c887dc7723c5010ec1">xwmm_mempool_page_allocate</a>(oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a053bc33ff6399770874b14c65bdb5390">pa</a>, oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#ae62b80a7807877435a82a08b2e62cfbd">pg_order</a>, &amp;pg);</div>
<div class="line"><span class="lineno">  248</span>                <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><span class="lineno">  249</span>                        <span class="keywordflow">goto</span> err_pg_alloc;</div>
<div class="line"><span class="lineno">  250</span>                }</div>
<div class="line"><span class="lineno">  251</span>                <a class="code hl_define" href="group__xwos__lib__xwaop.html#gadd1ff1c64048de270aac44c35a8519e7">xwaop_add</a>(<a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>, &amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#afc8c3ae5d542f2a700f5b2ac17aed6d2">capacity</a>, oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">pg_objnr</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  252</span>                <a class="code hl_define" href="group__xwos__lib__xwaop.html#gadd1ff1c64048de270aac44c35a8519e7">xwaop_add</a>(<a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a>, &amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#aca5c7fbe77e4fc6836679fc6f4189c3d">idleness</a>, oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">pg_objnr</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  253</span>                <a class="code hl_function" href="objcache_8c.html#a75c1bbc6602c82f1cc906c65303ee59d">xwmm_mempool_objcache_page_init</a>(oc, pg);</div>
<div class="line"><span class="lineno">  254</span>        }</div>
<div class="line"><span class="lineno">  255</span>        *pgbuf = pg;</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="group__xwos__lib__errno.html#ga6a72d49d869215a02342eb465166537b">XWOK</a>;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>err_pg_alloc:</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  260</span>}</div>
<div class="ttc" id="agroup__xwmm__mempool_html_ga7cbe7d0a7d7052c887dc7723c5010ec1"><div class="ttname"><a href="group__xwmm__mempool.html#ga7cbe7d0a7d7052c887dc7723c5010ec1">xwmm_mempool_page_allocate</a></div><div class="ttdeci">xwer_t xwmm_mempool_page_allocate(struct xwmm_mempool_page_allocator *pa, xwsq_t order, struct xwmm_mempool_page **pgbuf)</div><div class="ttdoc">XWMM API：申请一页内存</div><div class="ttdef"><b>Definition</b> <a href="page_8c_source.html#l00159">page.c:159</a></div></div>
<div class="ttc" id="agroup__xwos__lib__bclst_html_gaf6605d963c470c23c3031a450144d119"><div class="ttname"><a href="group__xwos__lib__bclst.html#gaf6605d963c470c23c3031a450144d119">xwlib_bclst_first_entry</a></div><div class="ttdeci">#define xwlib_bclst_first_entry(head, type, member)</div><div class="ttdoc">获得包含链表第一个节点的外层结构体的指针。</div><div class="ttdef"><b>Definition</b> <a href="bclst_8h_source.html#l00063">bclst.h:63</a></div></div>
<div class="ttc" id="agroup__xwos__lib__xwaop_html_gadd1ff1c64048de270aac44c35a8519e7"><div class="ttname"><a href="group__xwos__lib__xwaop.html#gadd1ff1c64048de270aac44c35a8519e7">xwaop_add</a></div><div class="ttdeci">#define xwaop_add(type, a, v, nv, ov)</div><div class="ttdoc">对原子变量进行原子操作：读取－相加－回写</div><div class="ttdef"><b>Definition</b> <a href="xwaop_8h_source.html#l00330">xwaop.h:330</a></div></div>
<div class="ttc" id="aobjcache_8c_html_a75c1bbc6602c82f1cc906c65303ee59d"><div class="ttname"><a href="objcache_8c.html#a75c1bbc6602c82f1cc906c65303ee59d">xwmm_mempool_objcache_page_init</a></div><div class="ttdeci">static void xwmm_mempool_objcache_page_init(struct xwmm_mempool_objcache *oc, struct xwmm_mempool_page *pg)</div><div class="ttdoc">初始化新页</div><div class="ttdef"><b>Definition</b> <a href="objcache_8c_source.html#l00115">objcache.c:115</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_aa90dcd466fd2d2df7008925e664d277d"><div class="ttname"><a href="structxwmm__mempool__objcache.html#aa90dcd466fd2d2df7008925e664d277d">xwmm_mempool_objcache::available</a></div><div class="ttdeci">struct xwlib_bclst_node available</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00056">objcache.h:56</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_ae62b80a7807877435a82a08b2e62cfbd"><div class="ttname"><a href="structxwmm__mempool__objcache.html#ae62b80a7807877435a82a08b2e62cfbd">xwmm_mempool_objcache::pg_order</a></div><div class="ttdeci">xwsq_t pg_order</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00040">objcache.h:40</a></div></div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a23e4915feeaf7a05d46ec2affe504642_cgraph.png" border="0" usemap="#aobjcache_8c_a23e4915feeaf7a05d46ec2affe504642_cgraph" alt=""/></div>
<map name="aobjcache_8c_a23e4915feeaf7a05d46ec2affe504642_cgraph" id="aobjcache_8c_a23e4915feeaf7a05d46ec2affe504642_cgraph">
<area shape="rect" title="获取一页，准备从页内存中分配对象" alt="" coords="5,214,185,254"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae" title="删除一个节点，并重新初始化它" alt="" coords="270,55,405,80"/>
<area shape="poly" title=" " alt="" coords="111,212,161,157,195,126,232,100,270,82,272,87,235,104,198,130,165,160,115,215"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga54d0d6c4a04b8f3c80891f7d0f5a1e62" title="测试链表是否为空。" alt="" coords="261,196,413,221"/>
<area shape="poly" title=" " alt="" coords="185,222,247,215,248,221,186,227"/>
<area shape="rect" href="objcache_8c.html#a75c1bbc6602c82f1cc906c65303ee59d" title="初始化新页" alt="" coords="247,114,427,154"/>
<area shape="poly" title=" " alt="" coords="144,211,274,157,276,162,146,216"/>
<area shape="rect" href="group__xwmm__mempool.html#ga7cbe7d0a7d7052c887dc7723c5010ec1" title="XWMM API：申请一页内存" alt="" coords="233,245,441,271"/>
<area shape="poly" title=" " alt="" coords="186,240,220,244,219,249,185,246"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb" title="XWOS API：开启写临界区，保存本地CPU的中断标志并关闭" alt="" coords="1056,433,1248,459"/>
<area shape="poly" title=" " alt="" coords="125,252,175,283,234,312,342,345,454,372,567,394,677,411,881,432,1042,441,1042,447,881,438,677,416,566,399,453,378,341,350,232,316,172,288,122,256"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8" title="XWOS API：关闭写临界区，恢复本地CPU的中断标志" alt="" coords="1077,254,1227,294"/>
<area shape="poly" title=" " alt="" coords="142,252,186,268,234,281,349,298,467,309,584,313,699,312,906,300,1063,284,1064,289,907,306,699,317,584,318,466,314,348,304,233,286,184,273,140,257"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab7918962f86f86d5c7049922a5173e81" title="删除prev节点与next节点之间的节点" alt="" coords="522,5,689,31"/>
<area shape="poly" title=" " alt="" coords="404,52,522,31,523,36,405,58"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569" title="初始化一个链表节点。" alt="" coords="532,55,679,80"/>
<area shape="poly" title=" " alt="" coords="405,65,518,65,518,70,405,70"/>
<area shape="poly" title=" " alt="" coords="405,111,489,89,526,80,527,85,490,94,406,117"/>
<area shape="rect" href="group__xwos__lib__lfq.html#gac87b1137608605a80577abed410ddc1a" title="初始化无锁队列节点" alt="" coords="557,104,654,129"/>
<area shape="poly" title=" " alt="" coords="427,126,543,118,543,123,428,131"/>
<area shape="rect" href="group__xwos__lib__lfq.html#ga1cac1b49ec185ccb135f19401e286166" title="将一个节点推入无锁队列（栈式队列）" alt="" coords="551,153,659,179"/>
<area shape="poly" title=" " alt="" coords="428,142,538,155,537,161,427,147"/>
<area shape="rect" href="page_8c.html#a6385524c294a6af40c2ea0ff315d60fd" title="将大的页拆分成小的页" alt="" coords="489,255,721,280"/>
<area shape="poly" title=" " alt="" coords="442,259,476,260,476,265,442,264"/>
<area shape="rect" href="page_8c.html#ab54f23d0058e1bff33377fc2d7b0a48c" title="从阶红黑树中选择一页" alt="" coords="783,197,994,237"/>
<area shape="poly" title=" " alt="" coords="441,244,489,239,770,220,770,225,490,245,442,249"/>
<area shape="rect" href="page_8c.html#adc418491ba0dd770fa96b845e96722d9" title="增加页到阶红黑树中" alt="" coords="769,356,1008,381"/>
<area shape="poly" title=" " alt="" coords="643,278,840,349,838,354,641,283"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaa09f90f7792b00240a3cecef84946d88" title="插入一个红色节点后修正红黑树的颜色" alt="" coords="1087,318,1217,358"/>
<area shape="poly" title=" " alt="" coords="998,353,1073,344,1073,350,998,359"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gaef7f6608cd37a0fb765adb003428ec38" title="链接节点，并设置位置及颜色信息" alt="" coords="1329,317,1447,343"/>
<area shape="poly" title=" " alt="" coords="1008,375,1125,377,1248,367,1295,358,1339,345,1340,350,1296,363,1248,373,1125,382,1008,380"/>
<area shape="poly" title=" " alt="" coords="934,379,1095,427,1094,432,932,384"/>
<area shape="poly" title=" " alt="" coords="950,353,1007,334,1031,319,1055,304,1071,297,1073,301,1057,308,1034,324,1009,339,951,359"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga3d27937625dc93286c012da5e82945b8" title="反转节点的颜色" alt="" coords="1313,177,1463,203"/>
<area shape="poly" title=" " alt="" coords="1216,321,1246,304,1263,282,1269,259,1276,235,1294,212,1301,207,1304,211,1298,216,1281,238,1274,260,1268,284,1250,308,1219,326"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga8e9025d3e8bade2a627001fb58251047" title="返回节点的父节点指针" alt="" coords="1308,227,1468,252"/>
<area shape="poly" title=" " alt="" coords="1215,315,1247,304,1349,256,1351,261,1249,308,1217,320"/>
<area shape="poly" title=" " alt="" coords="976,194,1037,185,1106,179,1178,179,1249,189,1273,199,1297,212,1323,220,1322,225,1295,216,1271,204,1247,194,1177,184,1106,184,1038,190,977,199"/>
<area shape="poly" title=" " alt="" coords="913,235,1058,368,1125,423,1121,427,1054,372,909,239"/>
<area shape="poly" title=" " alt="" coords="982,234,1064,252,1063,257,981,239"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga528f2863f2774a2f948db55c73ce6ee7" title="初始化红黑树节点" alt="" coords="1077,204,1227,229"/>
<area shape="poly" title=" " alt="" coords="994,214,1063,214,1063,219,994,219"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#gac57fdaeef6a9dc2ee2bedbf5ac885f96" title="删除一个节点，并修正红黑树的颜色" alt="" coords="1081,103,1223,128"/>
<area shape="poly" title=" " alt="" coords="935,194,1055,145,1097,130,1099,135,1057,150,937,199"/>
<area shape="poly" title=" " alt="" coords="1192,126,1249,145,1297,162,1326,171,1325,176,1295,167,1247,150,1191,131"/>
<area shape="poly" title=" " alt="" coords="1211,126,1250,145,1266,162,1274,180,1282,196,1298,212,1309,219,1307,223,1294,216,1278,199,1269,182,1261,165,1246,149,1209,130"/>
<area shape="poly" title=" " alt="" coords="1174,126,1211,153,1250,190,1265,210,1274,227,1283,244,1298,263,1325,287,1354,308,1351,312,1322,291,1294,266,1279,247,1269,229,1261,212,1246,193,1208,157,1171,130"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga2502fed0a895591911885bd8725de911" title="返回节点的后继节点" alt="" coords="1296,79,1480,104"/>
<area shape="poly" title=" " alt="" coords="1223,105,1282,99,1283,105,1224,111"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga692ff81d9c30fac79a823c5c2ff2357d" title="将节点设置为黑色" alt="" coords="1311,128,1465,153"/>
<area shape="poly" title=" " alt="" coords="1224,120,1297,128,1297,134,1223,126"/>
<area shape="rect" href="group__xwos__lib__rbtree.html#ga7b281445f2079f235077400ee79f15ea" title="用新节点代替旧节点并继承它的链指针、颜色和位置信息， 但新节点并不接管旧节点的子节点" alt="" coords="1310,29,1466,55"/>
<area shape="poly" title=" " alt="" coords="1187,100,1295,63,1322,56,1324,61,1297,69,1189,105"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a23e4915feeaf7a05d46ec2affe504642_icgraph.png" border="0" usemap="#aobjcache_8c_a23e4915feeaf7a05d46ec2affe504642_icgraph" alt=""/></div>
<map name="aobjcache_8c_a23e4915feeaf7a05d46ec2affe504642_icgraph" id="aobjcache_8c_a23e4915feeaf7a05d46ec2affe504642_icgraph">
<area shape="rect" title="获取一页，准备从页内存中分配对象" alt="" coords="1137,5,1317,45"/>
<area shape="rect" href="group__xwmm__mempool.html#ga86e445faf7ecf95130e042fa9b96a41b" title="XWMM API：从对象缓存中申请一个对象" alt="" coords="909,5,1089,45"/>
<area shape="poly" title=" " alt="" coords="1123,28,1089,28,1089,23,1123,23"/>
<area shape="rect" href="objcache_8c.html#a27d6631115c7033bfb49d22d5d3d992d" title="i_allocator接口函数：申请内存" alt="" coords="681,5,861,45"/>
<area shape="poly" title=" " alt="" coords="895,28,861,28,861,23,895,23"/>
<area shape="rect" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a" title="XWMM API：初始化对象缓存" alt="" coords="429,13,633,38"/>
<area shape="poly" title=" " alt="" coords="668,28,634,28,634,23,668,23"/>
<area shape="rect" href="allocator_8c.html#a6e1f6748cc378d09e931897b69231d0d" title="构建内存池" alt="" coords="199,13,381,38"/>
<area shape="poly" title=" " alt="" coords="416,28,382,28,382,23,416,23"/>
<area shape="rect" href="group__xwmm__mempool.html#gaad8340a12043c383e489a786788e89af" title="XWMM API：初始化内存池" alt="" coords="5,13,151,38"/>
<area shape="poly" title=" " alt="" coords="184,28,151,28,151,23,184,23"/>
</map>
</div>

</div>
</div>
<a id="a75c1bbc6602c82f1cc906c65303ee59d" name="a75c1bbc6602c82f1cc906c65303ee59d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75c1bbc6602c82f1cc906c65303ee59d">&#9670;&#160;</a></span>xwmm_mempool_objcache_page_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void xwmm_mempool_objcache_page_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *&#160;</td>
          <td class="paramname"><em>oc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> *&#160;</td>
          <td class="paramname"><em>pg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>初始化新页 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">oc</td><td>对象缓存的指针 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pg</td><td>页控制块的指针 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00115">115</a> 行定义.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>{</div>
<div class="line"><span class="lineno">  118</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> i;</div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#ga2d00153ecb0cdcc8ea0823c13ee59649">xwsz_t</a> loop;</div>
<div class="line"><span class="lineno">  120</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#gacef49946313c8d1985a8279bb40e31c4">xwptr_t</a> curr;</div>
<div class="line"><span class="lineno">  121</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#gacef49946313c8d1985a8279bb40e31c4">xwptr_t</a> next;</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>        <a class="code hl_function" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569">xwlib_bclst_init_node</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  124</span>        pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#aa87dbecfaa4f9c859311f560c5bfdf28">refcnt</a> = 0;</div>
<div class="line"><span class="lineno">  125</span>        pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a92a86e9c7241aa8d80d586a6168062c4">data</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a4e0eea86b489b7969ef1d4a309f17056">value</a> = oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a05389bc2c128416b3fa0b43671168b40">objsize</a>;</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">/* 构造所有对象 */</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="group__xwos__lib__type.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> != oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#adba198ae35ae05763c41a9370a6dcf58">ctor</a>) {</div>
<div class="line"><span class="lineno">  129</span>                curr = pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a86aa875179e54032edc2152789309c19">mapping</a>;</div>
<div class="line"><span class="lineno">  130</span>                next = curr;</div>
<div class="line"><span class="lineno">  131</span>                loop = oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">pg_objnr</a>;</div>
<div class="line"><span class="lineno">  132</span>                <span class="keywordflow">for</span> (i = 0; i &lt; loop; i++) {</div>
<div class="line"><span class="lineno">  133</span>                        next += oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a05389bc2c128416b3fa0b43671168b40">objsize</a>;</div>
<div class="line"><span class="lineno">  134</span>                        oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#adba198ae35ae05763c41a9370a6dcf58">ctor</a>((<span class="keywordtype">void</span> *)curr);</div>
<div class="line"><span class="lineno">  135</span>                        curr = next;</div>
<div class="line"><span class="lineno">  136</span>                }</div>
<div class="line"><span class="lineno">  137</span>        }</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>        <span class="comment">/* 初始化无锁队列 */</span></div>
<div class="line"><span class="lineno">  140</span>        <a class="code hl_function" href="group__xwos__lib__lfq.html#gac87b1137608605a80577abed410ddc1a">xwlib_lfq_init</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#ac3d78b8833f1da346fff3ead6ccc88ac">objhead</a>);</div>
<div class="line"><span class="lineno">  141</span>        curr = pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a86aa875179e54032edc2152789309c19">mapping</a>;</div>
<div class="line"><span class="lineno">  142</span>        next = curr;</div>
<div class="line"><span class="lineno">  143</span>        loop = oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#abd4c454f4dd3f8389fd1ada1a2504d02">pg_objnr</a>;</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">for</span> (i = 0; i &lt; loop; i++) {</div>
<div class="line"><span class="lineno">  145</span>                next += oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a05389bc2c128416b3fa0b43671168b40">objsize</a>;</div>
<div class="line"><span class="lineno">  146</span>                <a class="code hl_function" href="group__xwos__lib__lfq.html#gac87b1137608605a80577abed410ddc1a">xwlib_lfq_init</a>((<a class="code hl_typedef" href="group__xwos__lib__type.html#ga2225ca1f29b430d7c231a07487f1cc06">atomic_xwlfq_t</a> *)curr);</div>
<div class="line"><span class="lineno">  147</span>                <a class="code hl_function" href="group__xwos__lib__lfq.html#ga1cac1b49ec185ccb135f19401e286166">xwlib_lfq_push</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#ac3d78b8833f1da346fff3ead6ccc88ac">objhead</a>,</div>
<div class="line"><span class="lineno">  148</span>                               (<a class="code hl_typedef" href="group__xwos__lib__type.html#ga2225ca1f29b430d7c231a07487f1cc06">atomic_xwlfq_t</a> *)curr);</div>
<div class="line"><span class="lineno">  149</span>                curr = next;</div>
<div class="line"><span class="lineno">  150</span>        }</div>
<div class="line"><span class="lineno">  151</span>}</div>
<div class="ttc" id="agroup__xwos__lib__bclst_html_ga3286c94ae92265dea90fd52bfdb85569"><div class="ttname"><a href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569">xwlib_bclst_init_node</a></div><div class="ttdeci">static void xwlib_bclst_init_node(struct xwlib_bclst_node *n)</div><div class="ttdoc">初始化一个链表节点。</div><div class="ttdef"><b>Definition</b> <a href="bclst_8h_source.html#l00240">bclst.h:240</a></div></div>
<div class="ttc" id="agroup__xwos__lib__lfq_html_ga1cac1b49ec185ccb135f19401e286166"><div class="ttname"><a href="group__xwos__lib__lfq.html#ga1cac1b49ec185ccb135f19401e286166">xwlib_lfq_push</a></div><div class="ttdeci">static void xwlib_lfq_push(atomic_xwlfq_t *h, atomic_xwlfq_t *n)</div><div class="ttdoc">将一个节点推入无锁队列（栈式队列）</div><div class="ttdef"><b>Definition</b> <a href="lfq_8h_source.html#l00042">lfq.h:42</a></div></div>
<div class="ttc" id="agroup__xwos__lib__lfq_html_gac87b1137608605a80577abed410ddc1a"><div class="ttname"><a href="group__xwos__lib__lfq.html#gac87b1137608605a80577abed410ddc1a">xwlib_lfq_init</a></div><div class="ttdeci">static void xwlib_lfq_init(atomic_xwlfq_t *n)</div><div class="ttdoc">初始化无锁队列节点</div><div class="ttdef"><b>Definition</b> <a href="lfq_8h_source.html#l00031">lfq.h:31</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_ga2225ca1f29b430d7c231a07487f1cc06"><div class="ttname"><a href="group__xwos__lib__type.html#ga2225ca1f29b430d7c231a07487f1cc06">atomic_xwlfq_t</a></div><div class="ttdeci">__xwcc_atomic xwlfq_t atomic_xwlfq_t</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00594">type.h:594</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_gacef49946313c8d1985a8279bb40e31c4"><div class="ttname"><a href="group__xwos__lib__type.html#gacef49946313c8d1985a8279bb40e31c4">xwptr_t</a></div><div class="ttdeci">unsigned long xwptr_t</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00375">type.h:375</a></div></div>
<div class="ttc" id="astructxwmm__mempool__objcache_html_adba198ae35ae05763c41a9370a6dcf58"><div class="ttname"><a href="structxwmm__mempool__objcache.html#adba198ae35ae05763c41a9370a6dcf58">xwmm_mempool_objcache::ctor</a></div><div class="ttdeci">ctor_f ctor</div><div class="ttdef"><b>Definition</b> <a href="objcache_8h_source.html#l00048">objcache.h:48</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_a4e0eea86b489b7969ef1d4a309f17056"><div class="ttname"><a href="structxwmm__mempool__page.html#a4e0eea86b489b7969ef1d4a309f17056">xwmm_mempool_page::value</a></div><div class="ttdeci">xwsq_t value</div><div class="ttdef"><b>Definition</b> <a href="page_8h_source.html#l00061">page.h:61</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_a86aa875179e54032edc2152789309c19"><div class="ttname"><a href="structxwmm__mempool__page.html#a86aa875179e54032edc2152789309c19">xwmm_mempool_page::mapping</a></div><div class="ttdeci">xwptr_t mapping</div><div class="ttdef"><b>Definition</b> <a href="page_8h_source.html#l00040">page.h:40</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_a92a86e9c7241aa8d80d586a6168062c4"><div class="ttname"><a href="structxwmm__mempool__page.html#a92a86e9c7241aa8d80d586a6168062c4">xwmm_mempool_page::data</a></div><div class="ttdeci">union xwmm_mempool_page::@2 data</div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_aa87dbecfaa4f9c859311f560c5bfdf28"><div class="ttname"><a href="structxwmm__mempool__page.html#aa87dbecfaa4f9c859311f560c5bfdf28">xwmm_mempool_page::refcnt</a></div><div class="ttdeci">xwsq_t refcnt</div><div class="ttdef"><b>Definition</b> <a href="page_8h_source.html#l00053">page.h:53</a></div></div>
<div class="ttc" id="astructxwmm__mempool__page_html_ac3d78b8833f1da346fff3ead6ccc88ac"><div class="ttname"><a href="structxwmm__mempool__page.html#ac3d78b8833f1da346fff3ead6ccc88ac">xwmm_mempool_page::objhead</a></div><div class="ttdeci">atomic_xwlfq_t objhead</div><div class="ttdef"><b>Definition</b> <a href="page_8h_source.html#l00052">page.h:52</a></div></div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_cgraph.png" border="0" usemap="#aobjcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_cgraph" alt=""/></div>
<map name="aobjcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_cgraph" id="aobjcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_cgraph">
<area shape="rect" title="初始化新页" alt="" coords="5,47,185,87"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569" title="初始化一个链表节点。" alt="" coords="233,5,380,31"/>
<area shape="poly" title=" " alt="" coords="181,45,238,31,239,36,182,50"/>
<area shape="rect" href="group__xwos__lib__lfq.html#gac87b1137608605a80577abed410ddc1a" title="初始化无锁队列节点" alt="" coords="258,55,355,80"/>
<area shape="poly" title=" " alt="" coords="186,65,244,65,244,70,186,70"/>
<area shape="rect" href="group__xwos__lib__lfq.html#ga1cac1b49ec185ccb135f19401e286166" title="将一个节点推入无锁队列（栈式队列）" alt="" coords="253,104,361,129"/>
<area shape="poly" title=" " alt="" coords="182,85,240,98,239,104,181,90"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_icgraph.png" border="0" usemap="#aobjcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_icgraph" alt=""/></div>
<map name="aobjcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_icgraph" id="aobjcache_8c_a75c1bbc6602c82f1cc906c65303ee59d_icgraph">
<area shape="rect" title="初始化新页" alt="" coords="1365,37,1545,77"/>
<area shape="rect" href="objcache_8c.html#a23e4915feeaf7a05d46ec2affe504642" title="获取一页，准备从页内存中分配对象" alt="" coords="1137,5,1317,45"/>
<area shape="poly" title=" " alt="" coords="1351,45,1317,41,1318,35,1352,40"/>
<area shape="rect" href="group__xwmm__mempool.html#gaa72ed546dbddbbb8dd035c01c6334a24" title="XWMM API：预留对象到对象缓存中" alt="" coords="1137,69,1317,109"/>
<area shape="poly" title=" " alt="" coords="1352,75,1318,79,1317,74,1351,69"/>
<area shape="rect" href="group__xwmm__mempool.html#ga86e445faf7ecf95130e042fa9b96a41b" title="XWMM API：从对象缓存中申请一个对象" alt="" coords="909,5,1089,45"/>
<area shape="poly" title=" " alt="" coords="1123,28,1089,28,1089,23,1123,23"/>
<area shape="rect" href="objcache_8c.html#a27d6631115c7033bfb49d22d5d3d992d" title="i_allocator接口函数：申请内存" alt="" coords="681,5,861,45"/>
<area shape="poly" title=" " alt="" coords="895,28,861,28,861,23,895,23"/>
<area shape="rect" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a" title="XWMM API：初始化对象缓存" alt="" coords="429,13,633,38"/>
<area shape="poly" title=" " alt="" coords="668,28,634,28,634,23,668,23"/>
<area shape="rect" href="allocator_8c.html#a6e1f6748cc378d09e931897b69231d0d" title="构建内存池" alt="" coords="199,13,381,38"/>
<area shape="poly" title=" " alt="" coords="416,28,382,28,382,23,416,23"/>
<area shape="rect" href="group__xwmm__mempool.html#gaad8340a12043c383e489a786788e89af" title="XWMM API：初始化内存池" alt="" coords="5,13,151,38"/>
<area shape="poly" title=" " alt="" coords="184,28,151,28,151,23,184,23"/>
</map>
</div>

</div>
</div>
<a id="a6523b89f414d275f4c4548a684b21092" name="a6523b89f414d275f4c4548a684b21092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6523b89f414d275f4c4548a684b21092">&#9670;&#160;</a></span>xwmm_mempool_objcache_page_put()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void xwmm_mempool_objcache_page_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__objcache.html">xwmm_mempool_objcache</a> *&#160;</td>
          <td class="paramname"><em>oc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structxwmm__mempool__page.html">xwmm_mempool_page</a> *&#160;</td>
          <td class="paramname"><em>pg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>减少页的引用计数 </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">oc</td><td>对象缓存的指针 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pg</td><td>页控制块的指针 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>返回</dt><dd>错误码 </dd></dl>
<dl class="retval"><dt>返回值</dt><dd>
  <table class="retval">
    <tr><td class="paramname">XWOK</td><td>没有错误 </td></tr>
    <tr><td class="paramname">&lt;0</td><td>失败 </td></tr>
  </table>
  </dd>
</dl>
<p>&lt; 报告BUG</p>
<p>&lt; 当条件x成立时报告BUG</p>

<p class="definition">在文件 <a class="el" href="objcache_8c_source.html">objcache.c</a> 第 <a class="el" href="objcache_8c_source.html#l00197">197</a> 行定义.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>{</div>
<div class="line"><span class="lineno">  200</span>        <a class="code hl_typedef" href="group__xwos__lib__type.html#gad21f70aa6f1364b63b1165784448bc16">xwreg_t</a> flag;</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>        <a class="code hl_function" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb">xwos_sqlk_wr_lock_cpuirqsv</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, &amp;flag);</div>
<div class="line"><span class="lineno">  203</span>        <a class="code hl_define" href="group__xwos__standard.html#ga1bab891fe9a97ea85286bc6e44a88c17">XWOS_BUG_ON</a>((<a class="code hl_typedef" href="group__xwos__lib__type.html#ga59fe68c80516b22de8dccb84275d23f2">xwsq_t</a>)0 == pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#aa87dbecfaa4f9c859311f560c5bfdf28">refcnt</a>);</div>
<div class="line"><span class="lineno">  204</span>        pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#aa87dbecfaa4f9c859311f560c5bfdf28">refcnt</a>--;</div>
<div class="line"><span class="lineno">  205</span>        <a class="code hl_function" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae">xwlib_bclst_del_init</a>(&amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="group__xwos__lib__type.html#ga59fe68c80516b22de8dccb84275d23f2">xwsq_t</a>)0 == pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#aa87dbecfaa4f9c859311f560c5bfdf28">refcnt</a>) {</div>
<div class="line"><span class="lineno">  207</span>                <a class="code hl_function" href="group__xwos__lib__bclst.html#ga942be8d64e19cb8efb4dd1cf10e6e706">xwlib_bclst_add_head</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a26d781cc1112808f876f0d2551da2d30">idle</a>,</div>
<div class="line"><span class="lineno">  208</span>                                     &amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  209</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  210</span>                <a class="code hl_function" href="group__xwos__lib__bclst.html#ga942be8d64e19cb8efb4dd1cf10e6e706">xwlib_bclst_add_head</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#aa90dcd466fd2d2df7008925e664d277d">available</a>,</div>
<div class="line"><span class="lineno">  211</span>                                     &amp;pg-&gt;<a class="code hl_variable" href="structxwmm__mempool__page.html#a678e3535823e3eab676917331f622473">attr</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#adc80ae7e64a16dfabb3c173ba80fcd5a">objcache</a>.<a class="code hl_variable" href="structxwmm__mempool__page.html#a12866c4340feabc2fade6a9d5a7dbb16">node</a>);</div>
<div class="line"><span class="lineno">  212</span>        }</div>
<div class="line"><span class="lineno">  213</span>        <a class="code hl_function" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8">xwos_sqlk_wr_unlock_cpuirqrs</a>(&amp;oc-&gt;<a class="code hl_variable" href="structxwmm__mempool__objcache.html#af5710f3b100420dbdd54cfcb952877fc">page_list</a>.<a class="code hl_variable" href="structxwmm__mempool__objcache.html#a6d27d017089b61643a2248a048b26ef8">lock</a>, flag);</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="ttc" id="agroup__xwos__lib__bclst_html_ga942be8d64e19cb8efb4dd1cf10e6e706"><div class="ttname"><a href="group__xwos__lib__bclst.html#ga942be8d64e19cb8efb4dd1cf10e6e706">xwlib_bclst_add_head</a></div><div class="ttdeci">static void xwlib_bclst_add_head(struct xwlib_bclst_node *head, struct xwlib_bclst_node *newn)</div><div class="ttdoc">将一个节点加入链表头部（链表头的后面）</div><div class="ttdef"><b>Definition</b> <a href="bclst_8h_source.html#l00345">bclst.h:345</a></div></div>
<div class="ttc" id="agroup__xwos__lib__type_html_ga59fe68c80516b22de8dccb84275d23f2"><div class="ttname"><a href="group__xwos__lib__type.html#ga59fe68c80516b22de8dccb84275d23f2">xwsq_t</a></div><div class="ttdeci">unsigned long xwsq_t</div><div class="ttdef"><b>Definition</b> <a href="type_8h_source.html#l00445">type.h:445</a></div></div>
<div class="ttc" id="agroup__xwos__standard_html_ga1bab891fe9a97ea85286bc6e44a88c17"><div class="ttname"><a href="group__xwos__standard.html#ga1bab891fe9a97ea85286bc6e44a88c17">XWOS_BUG_ON</a></div><div class="ttdeci">#define XWOS_BUG_ON(x)</div><div class="ttdef"><b>Definition</b> <a href="xwos_2standard_8h_source.html#l00057">standard.h:57</a></div></div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a6523b89f414d275f4c4548a684b21092_cgraph.png" border="0" usemap="#aobjcache_8c_a6523b89f414d275f4c4548a684b21092_cgraph" alt=""/></div>
<map name="aobjcache_8c_a6523b89f414d275f4c4548a684b21092_cgraph" id="aobjcache_8c_a6523b89f414d275f4c4548a684b21092_cgraph">
<area shape="rect" title="减少页的引用计数" alt="" coords="5,73,185,113"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga942be8d64e19cb8efb4dd1cf10e6e706" title="将一个节点加入链表头部（链表头的后面）" alt="" coords="254,5,405,31"/>
<area shape="poly" title=" " alt="" coords="146,70,233,39,260,32,261,37,234,45,148,75"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab12f3ce1a4e53de3112b10c9ffb06cae" title="删除一个节点，并重新初始化它" alt="" coords="262,55,397,80"/>
<area shape="poly" title=" " alt="" coords="185,80,248,73,248,79,186,86"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gabc138d69277ba1017ade0f27c6c282cb" title="XWOS API：开启写临界区，保存本地CPU的中断标志并关闭" alt="" coords="233,104,425,129"/>
<area shape="poly" title=" " alt="" coords="186,99,220,103,220,108,185,105"/>
<area shape="rect" href="group__xwos__lock__seqlock.html#gadcb38d5d6dad7969e1231c47c131f3c8" title="XWOS API：关闭写临界区，恢复本地CPU的中断标志" alt="" coords="254,154,405,194"/>
<area shape="poly" title=" " alt="" coords="153,110,234,139,256,147,254,152,232,145,151,115"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga42c09bc0da5cac8327003314056f43b7" title="将一个新节点加入到prev与next之间" alt="" coords="473,5,644,31"/>
<area shape="poly" title=" " alt="" coords="405,15,459,15,459,21,405,21"/>
<area shape="rect" href="group__xwos__lib__bclst.html#gab7918962f86f86d5c7049922a5173e81" title="删除prev节点与next节点之间的节点" alt="" coords="475,55,642,80"/>
<area shape="poly" title=" " alt="" coords="397,65,462,65,462,70,397,70"/>
<area shape="rect" href="group__xwos__lib__bclst.html#ga3286c94ae92265dea90fd52bfdb85569" title="初始化一个链表节点。" alt="" coords="485,104,632,129"/>
<area shape="poly" title=" " alt="" coords="390,77,486,98,485,104,388,83"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="objcache_8c_a6523b89f414d275f4c4548a684b21092_icgraph.png" border="0" usemap="#aobjcache_8c_a6523b89f414d275f4c4548a684b21092_icgraph" alt=""/></div>
<map name="aobjcache_8c_a6523b89f414d275f4c4548a684b21092_icgraph" id="aobjcache_8c_a6523b89f414d275f4c4548a684b21092_icgraph">
<area shape="rect" title="减少页的引用计数" alt="" coords="1167,5,1347,45"/>
<area shape="rect" href="group__xwmm__mempool.html#gae7d39e7ba00cc3926284e6ba8775121b" title="XWMM API：释放对象到对象缓存中" alt="" coords="909,13,1119,38"/>
<area shape="poly" title=" " alt="" coords="1153,28,1119,28,1119,23,1153,23"/>
<area shape="rect" href="objcache_8c.html#a7214f0b448c3680b68f84d3bb6d7155a" title="i_allocator接口函数：释放内存" alt="" coords="681,5,861,45"/>
<area shape="poly" title=" " alt="" coords="896,28,862,28,862,23,896,23"/>
<area shape="rect" href="group__xwmm__mempool.html#ga15d8fc6d72d2ef920927bd6702174c3a" title="XWMM API：初始化对象缓存" alt="" coords="429,13,633,38"/>
<area shape="poly" title=" " alt="" coords="668,28,634,28,634,23,668,23"/>
<area shape="rect" href="allocator_8c.html#a6e1f6748cc378d09e931897b69231d0d" title="构建内存池" alt="" coords="199,13,381,38"/>
<area shape="poly" title=" " alt="" coords="416,28,382,28,382,23,416,23"/>
<area shape="rect" href="group__xwmm__mempool.html#gaad8340a12043c383e489a786788e89af" title="XWMM API：初始化内存池" alt="" coords="5,13,151,38"/>
<area shape="poly" title=" " alt="" coords="184,28,151,28,151,23,184,23"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_43a52829888b753087a6774748486ed5.html">xwos</a></li><li class="navelem"><a class="el" href="dir_9dc98d2d57b5a37b2d02400b59474658.html">mm</a></li><li class="navelem"><a class="el" href="dir_be5874c8726cf154b99a7d6ef7f00d55.html">mempool</a></li><li class="navelem"><a class="el" href="objcache_8c.html">objcache.c</a></li>
    <li class="footer">制作者 <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
